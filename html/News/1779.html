<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>如何学习AngularJS_AngularJS_夜鹰教程网 </title>
    <meta name="keywords" content="夜鹰教程网 承接业务：软件开发 网站开发 网页设计 移动互联网app开发 asp.net+C#+vs2008/vs2010/vs2012/vs2015+MSsql2005/2008+Jquery+3G移动互联网解决方案" />
    <meta name="description" content="前端技巧的进展是如斯之快，种种优异技巧、优异框架的涌现的确让人琳琅满目，松跟期间潮水，进修控制新学问天然是没有敢怠缓。&nbsp;AngularJS是谷歌正在保护，其正在外洋已非常炽热" />
    <meta name="author" content="夜鹰教程网" />
    <meta name="Copyright" content="www.yyjcw.com " />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
    <link href="/css/Common20121012.css" rel="stylesheet" type="text/css" />
    <link href="/css/NewsView20121012.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" language="javascript" src="/js/tangyan.js"></script>
    <script type="text/javascript" language="javascript" src="/js/jquery-1.7.1.min.js"></script>
</head>
<body>
    <form name="aspnetForm" method="post" id="aspnetForm">
  <div class="outcontainer"><div class="incontainner" style="background-image:url(/images/TopDate.gif); border:solid 1px #ccc; border-top:0; border-bottom:0; "><div id="topleft">&nbsp;本站业务范围：1、PC端软件开发、网站开发 2、移动端APP、网站、微信接口、微商城开发 3、视频教程、毕业设计辅导</div> <div id="topright">·<a href="javascript:void(0);" onclick="setHomepage('http://www.yyjcw.com');return false;">设为首页</a>·<a href="javascript:void(0);" onclick="addCookie('夜鹰教程网欢迎您!','http://www.yyjcw.com');return false;">加入收藏</a>&nbsp;<span id="now"></span>&nbsp;<a href="/xml/rss.xml" target="_blank"><img src="/images/rss.gif" alt="" style="border: 0;" /></a>&nbsp;</div></div></div>
<div class="outcontainer"><div class="incontainner" style=" background-image:url(/images/logoinline.gif); background-repeat:repeat-x;border:solid 1px #ccc;background-position:0 -7px; "><img src="/images/linklogo.gif" alt="" /><div id="nav"><p><a href="/index.html">本站首页</a><a href="/list.html">优惠活动</a><a href="/html/News/AboutUs_5.html">技术辅导</a><a href="/html/News/AboutUs_4.html">网站开发</a><a href="/ac/cloud/" style="">教程介绍</a><a target="_blank" href="/ac/vip/">尊贵服务</a><a href="/html/News/NewsList_2_1.html">技术文章</a><a target="_blank" href="/tuangou.html">最新活动</a><a target="_blank" href="/ac/tx/xuyuanqiang/">最新评论</a><a href="/mulu.html">教程目录</a><a target="_blank" href="/ac/piclist/">视频截图</a><a target="_blank" href="/ac/lucky/">在线抽奖</a></p></div><div id="buyvideo">你好，欢迎来到夜鹰网！【<a href="http://www.yyjcw.com/tuangou.html" target="_blank">去购买教程</a>】</div></div></div>
<div class="outcontainer" style="border: solid 1px white;border-left:0;border-right: 0;">
<div class="incontainner" id="search" >
<div style="clear:both;position:relative;"><div class="topNotice"><ul><li><a href="/html/News/1461.html">《夜鹰教程网sql2008视频教程》后记：任何企业都有很多的数据需要处理,学习数据库知识，提高数据处理能力，势在必行，志在必得。</a></li><li><a href="/html/News/1409.html">《原创OA视频教程》火热销售中技术不等人，发了工资就来买教程 ^_^!</a></li><li><a href="/html/News/1317.html">《asp.net+sql server制作信息发布系统》 个性签名：配角？不做！助理？不做！要做就做买得起房，开得起车，拒绝裸婚的新好青年！</a></li><li><a href="/html/News/1334.html">Asp.net培训教程视频【C#版】 举一反三，发散思维，逆水行舟，不进则退。</a></li><li><a href="/html/News/1342.html">《Asp.Net+Sql Server制作企业网站》视频教程,我们在这里等您。</a></li><li><a href="/html/News/1396.html">《Asp.Net制作带购物车的电子商务网站》尊贵服务，从夜鹰教程开始。</a></li><li><a href="/html/News/1364.html">视频教程《C#语法基础视频教程》最直接的视频教程，开门见山的视频教程。</a></li><li><a href="/html/News/1397.html">《Asp.net编程技巧范例大全》 熟能生巧，提高效率，要讲技巧。</a></li><li><a href="/html/News/1420.html">夜鹰教程网前端开发视频教程 注重用户体验，改善用户体验，提高性能，改善性能，优化结构。 </a></li><li><a href="/html/News/1454.html">【强烈推荐】jquery基础视频教程，做得多，写得少。do more,write less!兼容性好，效率高，各种特效，插件多。</a></li><li><a href="/html/News/1338.html">Asp.net+sql制作留言板</a></li><li><a href="/html/News/1331.html">《Asp.net+sql制作音乐网站》FLASH与asp.net通讯，xml作为桥梁</a></li></ul></div><a href="http://sighttp.qq.com/cgi-bin/check?sigkey=05a95cdf3fa1602e580171226ada682ed2d4a1cb451bf047f1e4969e5fc7b62d"; target="_blank" onclick="var tempSrc='http://sighttp.qq.com/wpa.js?rantime='+Math.random()+'&sigkey=05a95cdf3fa1602e580171226ada682ed2d4a1cb451bf047f1e4969e5fc7b62d';var oldscript=document.getElementById('testJs');var newscript=document.createElement('script');newscript.setAttribute('type','text/javascript'); newscript.setAttribute('id', 'testJs');newscript.setAttribute('src',tempSrc);if(oldscript == null){document.body.appendChild(newscript);}else{oldscript.parentNode.replaceChild(newscript, oldscript);}return false;" style=" display:inline; clear:both;  right:3px; position:absolute; line-height:22px;top:3px; background-color:White; border:solid 1px green; ">&nbsp;购买教程&nbsp;QQ:1416759661&nbsp;<img border="0" SRC='http://wpa.qq.com/pa?p=1:1416759661:10' alt="购买教程" align="absmiddle">&nbsp;</a></div>
</div>
</div>
<div class="outcontainer">
<div class="incontainner">
<a href="/tuangou.html"><img src="/images/03.jpg" alt="" style=" width:987px; margin-top:2px;"/></a>
<div style=" clear:both;"></div>
</div>
</div>
<table id="nei_body" cellpadding="0" cellspacing="0">
        <tr>
            <td>
                <table cellspacing="0" cellpadding="0" id="nei_tbtitle">
                    <tr>
                        <td colspan="2" align="left" valign="middle" class="nei_title">
                            &nbsp;<img src="/images/greendiamond.gif" alt="" />当前位置：<a href="/html/News/NewsList_0_1.html" target="_blank">文章中心</a> &gt;&gt; AngularJS
                        </td>
                    </tr>
                </table>
                <table align="center" cellpadding="0" cellspacing="0" id="nei_tbcenter">
                    <tr>
                        <td class="tdboder_ccc" id="nei_content_left">
                            <table class="tb_title">
                                <tr>
                                    <td id="td_title">
                                        如何学习AngularJS
                                    </td>
                                </tr>
                                <tr>
                                    <td id="td_date">
                                        <a href="http://www.yyjcw.com" target="_blank" title="最便宜的网站建设_视频教程_FLASH__ASP_ASP.NET_SQL2000_SQL2005_AJAX_FLEX_3ds max_Photoshop cs4_夜鹰教程网_www.yyjcw.com">夜鹰教程网</a> 来源：www.yyjcw.com 日期：2016/11/6 0:19:28
          
<div id="ckepop" style="float:right;"><span class="jiathis_txt">分享到：</span>
<a class="jiathis_button_qzone"></a>
<a class="jiathis_button_tsina"></a>
<a class="jiathis_button_tqq"></a>
<a class="jiathis_button_renren"></a>
<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
<a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" >
var jiathis_config={
	siteNum:10,
	sm:"tsina,tqq,t163,douban,tsohu,xiaoyou,tianya,hi,renren,copy",
	summary:"",
	boldNum:6,
	hideMore:false
}
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script>
           </td>
                                </tr>
                            </table>
                            <table class="tb_title">
                                <tr>
                                    <td class="td_brief" style="border: solid 1px #ccc; width: 100%;">
                                        前端技巧的进展是如斯之快，种种优异技巧、优异框架的涌现的确让人琳琅满目，松跟期间潮水，进修控制新学问天然是没有敢怠缓。&nbsp;AngularJS是谷歌正在保护，其正在外洋已非常炽热
                                    </td>
                                </tr>
                            </table>
                            <table class="tb_title">
                                <tr>
                                    <td class="td_brief" style="border: solid 1px #ccc; width: 100%;">
                                        <p><img src="/images/2Code.jpg" style="float:right;"/></p><p><span style="color: rgb(192, 80, 77); font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">计算机技术辅导。</span></p><p><span style="color: rgb(192, 80, 77); font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">QQ：1416759661 &nbsp; 新手求救QQ群：7835003</span></p><p><span style="color: rgb(192, 80, 77); font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">如果您遇到技术难题，</span><span style="color: rgb(192, 80, 77); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">需要远程调试都可以加我们QQ</span></p><p>技术咨询： <a target="_blank" href="http://www.taobao.com/webww/ww.php?ver=3&touid=%E5%A4%9C%E9%B9%B0%E9%97%AA%E5%AE%A2%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B%E7%BD%91&siteid=cntaobao&status=1&charset=utf-8"><img border="0" src="http://amos.alicdn.com/realonline.aw?v=2&uid=%E5%A4%9C%E9%B9%B0%E9%97%AA%E5%AE%A2%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B%E7%BD%91&site=cntaobao&s=1&charset=utf-8" alt="购买教程"/></a>
 &nbsp;技术咨询：<a href="http://sighttp.qq.com/cgi-bin/check?sigkey=05a95cdf3fa1602e580171226ada682ed2d4a1cb451bf047f1e4969e5fc7b62d" target="_blank" onclick="var tempSrc=&#39;http://sighttp.qq.com/wpa.js?rantime=&#39;+Math.random()+&#39;&amp;sigkey=05a95cdf3fa1602e580171226ada682ed2d4a1cb451bf047f1e4969e5fc7b62d&#39;;var oldscript=document.getElementById(&#39;testJs&#39;);var newscript=document.createElement(&#39;script&#39;);newscript.setAttribute(&#39;type&#39;,&#39;text/javascript&#39;); newscript.setAttribute(&#39;id&#39;, &#39;testJs&#39;);newscript.setAttribute(&#39;src&#39;,tempSrc);if(oldscript == null){document.body.appendChild(newscript);}else{oldscript.parentNode.replaceChild(newscript, oldscript);}return false;"><img border="0" src="http://wpa.qq.com/pa?p=1:1416759661:10" alt="购买教程"/></a></p>
                                    </td>
                                </tr>
                            </table>
                            <table class="tb_title">
                                <tr>
                                    <td id="td_content">
                                        <p>[摘要：1 媒介 前端技巧的进展是如斯之快，种种优异技巧、优异框架的涌现的确让人琳琅满目，松跟期间潮水，进修控制新学问天然是没有敢怠缓。 AngularJS是谷歌正在保护，其正在外洋已非常炽热]</p><p><br/></p><p>1 前言</p><p>前端技术的发展是如此之快，各种优秀技术、优秀框架的出现简直让人目不暇接，紧跟时代潮流，学习掌握新知识自然是不敢怠慢。</p><p><br/></p><p>AngularJS是google在维护，其在国外已经十分火热，可是国内的使用情况却有不小的差距，参考文献/网络文章也很匮乏。这里便将我学习AngularJS写成文档，一方面作为自己学习路程上的记录，另一方面也给有兴趣的同学一些参考。</p><p><br/></p><p>首先我自己也是一名学习者，会以学习者的角度来整理我的行文思路，这里可能只是些探索，有理解或是技术上的错误还请大家指出；其次我特别喜欢编写小例子来把一件事情说明白，故在文中会尽可能多的用示例加代码讲解，我相信这会是一种比较好的方式；最后，我深知AngularJS的使用方式跟jquery的使用方式有很大不同，在大家都有jquery、ext经验的条件下对于angular的学习会困难重重，不过我更相信在大家的坚持下，能够快速的学好AngularJS，至少咱也能深入了解到AngularJS的基本思想，对咱们以后自己的插件开发、项目开发都会有很大的启示。</p><p><br/></p><p>2 AngularJS概述</p><p>2.1 AngularJS是什么？</p><p><br/></p><p>AngularJs（后面就简称ng了）是一个用于设计动态web应用的结构框架。首先，它是一个框架，不是类库，是像EXT一样提供一整套方案用于设计web应用。它不仅仅是一个javascript框架，因为它的核心其实是对HTML标签的增强。</p><p><br/></p><p>何为HTML标签增强？其实就是使你能够用标签完成一部分页面逻辑，具体方式就是通过自定义标签、自定义属性等，这些HTML原生没有的标签/属性在ng中有一个名字：指令（directive）。后面会详细介绍。那么，什么又是动态web应用呢？与传统web系统相区别，web应用能为用户提供丰富的操作，能够随用户操作不断更新视图而不进行url跳转。ng官方也声明它更适用于开发CRUD应用，即数据操作比较多的应用，而非是游戏或图像处理类应用。</p><p><br/></p><p>为了实现这些，ng引入了一些非常棒的特性，包括模板机制、数据绑定、模块、指令、依赖注入、路由。通过数据与模板的绑定，能够让我们摆脱繁琐的DOM操作，而将注意力集中在业务逻辑上。</p><p><br/></p><p>　 另外一个疑问，ng是MVC框架吗？还是MVVM框架？官网有提到ng的设计采用了MVC的基本思想，而又不完全是MVC，因为在书写代码时我们确实是在用ng-controller这个指令(起码从名字上看，是MVC吧)，但这个controller处理的业务基本上都是与view进行交互，这么看来又很接近MVVM。让我们把目光移到官网那个非醒目的title上：“AngularJS — Superheroic JavaScript MVW Framework”。</p><p><br/></p><p>2.2 AngularJS简单介绍</p><p><br/></p><p>AngularJS 重新定义了前端应用的开发方式。面对HTML和JavaScript之间的界线，它</p><p><br/></p><p>非但不畏缩不前，反而正面出击，提出了有效的解决方案。</p><p><br/></p><p>很多前端应用的开发框架，比如Backbone、EmberJS等，都要求开发者继承此框架特有的一些JavaScript对象。这种方式有其长处，但它不必要地污染了开发者自己代码的对象空间，还要求开发者去了解内存里那些抽象对象。尽管如此我们还是接受了这种方式，因为网络最初的设计无法提供 我们今天所需的交互性，于是我们需要框架，来帮我们填补JavaScript和HTML之间的鸿沟。而且有了它，你不用再“直接”操控DOM，只要给你的DOM注上metadata（即AngularJS里的directive们），然后让AngularJS来帮你操纵DOM。同时，AngularJS不依赖（也不妨碍）任何其他的框架。你甚至可以基于其它的框架来开发AngularJS应用。</p><p><br/></p><p>API地址：http://docs.angularjs.org/api/；</p><p><br/></p><p>AngularJS在github上的中文粗译版地址：https://github.com/basestyle/angularjs-cn。</p><p><br/></p><p>2.3 什么时候该用AngularJS</p><p><br/></p><p>AngularJS是一个 MV* 框架，最适于开发客户端的单页面应用。它不是个功能库，而是用来开发动态网页的框架。它专注于扩展HTML的功能，提供动态数据绑定（data binding），而且它能跟其它框架（如jQuery）合作融洽。</p><p><br/></p><p>如果你要开发的是单页应用，AngularJS就是你的上上之选。Gmail、Google Docs、Twitter和Facebook这样的应用，都很能发挥AngularJS的长处。但是像游戏开发之类对DOM进行大量操纵、又或者单纯需要 极高运行速度的应用，就不是AngularJS的用武之地了。</p><p><br/></p><p>3 AugularJS特性</p><p>AngularJS是一个新出现的强大客户端技术，提供给大家的一种开发强大应用的方式。这种方式利用并且扩展HTML，CSS和javascript，并且弥补了它们的一些非常明显的不足。本应该使用HTML来实现而现在由它开发的动态一些内容。</p><p><br/></p><p>AngularJS有五个最重要的功能和特性：</p><p><br/></p><p>3.1 特性一：双向的数据绑定</p><p><br/></p><p>数据绑定可能是AngularJS最酷最实用的特性。它能够帮助你避免书写大量的初始代码从而节约开发时间。一个典型的web应用可能包含了80%的代码用来处理，查询和监听DOM。数据绑定是的代码更少，你可以专注于你的应用。</p><p><br/></p><p>我们想象一下Model是你的应用中的简单事实。你的Model是你用来读取或者更新的部分。数据绑定指令提供了你的Model投射到view的方法。这些投射可以无缝的，毫不影响的应用到web应用中。</p><p><br/></p><p>传统来说，当model变化了。 开发人员需要手动处理DOM元素并且将属性反映到这些变化中。这个一个双向的过程。一方面，model变化驱动了DOM中元素变化，另一方面，DOM元素的变化也会影响到Model。这个在用户互动中更加复杂，因为开发人员需要处理和解析</p><p><br/></p><p>这些互动，然后融合到一个model中，并且更新View。这是一个手动的复杂过程，当一个应用非常庞大的时候，将会是一件非常费劲的事情。</p><p><br/></p><p>这里肯定有更好的解决方案！那就是AngularJS的双向数据绑定，能够同步DOM和Model等等。</p><p><br/></p><p>这里有一个非常简单的例子，用来演示一个input输入框和&lt;h1&gt;元素的双向绑定(例01)：</p><p><br/></p><p>&lt;!doctype html&gt;</p><p><br/></p><p>&lt;html ng-app=&quot;demoApp&quot;&gt;</p><p><br/></p><p>&nbsp; &lt;head&gt;</p><p><br/></p><p>&nbsp; &nbsp; &lt;script src=&quot;http://m.cnblogs.com/142260/js/angular.min.js&quot; rel=&quot;nofollow&quot;/&gt;</p><p><br/></p><p>&nbsp; &lt;/head&gt;</p><p><br/></p><p>&nbsp; &lt;body&gt;</p><p><br/></p><p>&nbsp; &nbsp; &lt;div&gt;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &lt;label&gt;Name:&lt;/label&gt;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &lt;input type=&quot;text&quot; ng-model=&quot;user.name&quot; placeholder=&quot;请输入名字&quot;&gt;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &lt;hr&gt;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &lt;h1&gt;Hello, {{user.name}}!&lt;/h1&gt;</p><p><br/></p><p>&nbsp; &nbsp; &lt;/div&gt;</p><p><br/></p><p>&nbsp; &lt;/body&gt;</p><p><br/></p><p>&lt;/html&gt;</p><p><br/></p><p>说明：实际效果请大家看AngularJS/demo/index.html</p><p><br/></p><p>3.2 特性二：模板</p><p><br/></p><p>在AngularJS中，一个模板就是一个HTML文件。但是HTML的内容扩展了，包含了很多帮助你映射model到view的内容。</p><p><br/></p><p>HTML模板将会被浏览器解析到DOM中。DOM然后成为AngularJS编译器的输入。AngularJS将会遍历DOM模板来生成一些指导，即，directive（指令）。所有的指令都负责针对view来设置数据绑定。</p><p><br/></p><p>我们要理解AuguarJS并不把模板当做String来操作。输入AngularJS的是DOM而非string。数据绑定是DOM变化，不是字符串的连接或者innerHTML变化。使用DOM作为输入，而不是字符串，是AngularJS区别于其它的框架的最大原因。使用DOM允许你扩展指令词汇并且可以创建你自己的指令，甚至开发可重用的组件。</p><p><br/></p><p>最大的好处是为设计师和开发者创建了一个紧密的工作流。设计师可以像往常一样开发标签，然后开发者拿过来添加上功能，通过数据绑定将会使得这个过程非常简单。</p><p><br/></p><p>这里有一个例子，我们使用ng-repeat指令来循环图片数组并且加入img模板，如下：</p><p><br/></p><p>function AlbumCtrl($scope) {</p><p><br/></p><p>&nbsp; &nbsp; scope.images = [</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; {&quot;image&quot;:&quot;img/image_01.png&quot;, &quot;description&quot;:&quot;Image 01 description&quot;},</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; {&quot;image&quot;:&quot;img/image_02.png&quot;, &quot;description&quot;:&quot;Image 02 description&quot;},</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; {&quot;image&quot;:&quot;img/image_03.png&quot;, &quot;description&quot;:&quot;Image 03 description&quot;},</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; {&quot;image&quot;:&quot;img/image_04.png&quot;, &quot;description&quot;:&quot;Image 04 description&quot;},</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; {&quot;image&quot;:&quot;img/image_05.png&quot;, &quot;description&quot;:&quot;Image 05 description&quot;}</p><p><br/></p><p>&nbsp; &nbsp; ];</p><p><br/></p><p>}</p><p><br/></p><p>&lt;div ng-controller=&quot;AlbumCtrl&quot;&gt;</p><p><br/></p><p>&nbsp; &lt;ul&gt;</p><p><br/></p><p>&nbsp; &nbsp; &lt;li ng-repeat=&quot;image in images&quot;&gt;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &lt;img ng-src=&quot;http://m.cnblogs.com/142260/{{image.thumbnail}}&quot; rel=&quot;nofollow&quot;/&gt;</p><p><br/></p><p>&nbsp; &nbsp; &lt;/li&gt;</p><p><br/></p><p>&nbsp; &lt;/ul&gt;</p><p><br/></p><p>&lt;/div&gt;</p><p><br/></p><p>这里还有一件事值得提一句，AngularJS并不强制你学习一个新的语法或者从你的应用中提出你的模板。</p><p><br/></p><p>3.3 特性三：MVC</p><p><br/></p><p>针对客户端应用开发AngularJS吸收了传统的MVC基本原则。MVC或者Model-View-Controll设计模式针对不同的人可能意味不同的东西。AngularJS并不执行传统意义上的MVC，更接近于MVVM（Moodel-View-ViewModel)。&nbsp;</p><p><br/></p><p>Model</p><p><br/></p><p>model是应用中的简单数据。一般是简单的javascript对象。这里没有必要继承框架的classes，使用proxy对象封装或者使用特别的setter/getter方法来访问。事实上我们处理vanilla javascript的方法就是一个非常好的特性，这种方法使得我们更少使用应用的原型。</p><p><br/></p><p>ViewModel</p><p><br/></p><p>viewmodel是一个用来提供特别数据和方法从而维护指定view的对象。</p><p><br/></p><p>viewmodel是$scope的对象，只存在于AnguarJS的应用中。$scope只是一个简单的js对象，这个对象使用简单的API来侦测和广播状态变化。</p><p><br/></p><p>Controller</p><p><br/></p><p>controller负责设置初始状态和参数化$scope方法用以控制行为。需要指出的controller并不保存状态也不和远程服务互动。</p><p><br/></p><p>View</p><p><br/></p><p>view是AngularJS解析后渲染和绑定后生成的HTML 。这个部分帮助你创建web应用的架构。$scope拥有一个针对数据的参考，controller定义行为，view处理布局和互动。</p><p><br/></p><p>3.4 特性四：服务和依赖注入</p><p><br/></p><p>AngularJS服务其作用就是对外提供某个特定的功能。</p><p><br/></p><p>AngularJS拥有内建的依赖注入（DI）子系统，可以帮助开发人员更容易的开发，理解和测试应用。</p><p><br/></p><p>DI允许你请求你的依赖，而不是自己找寻它们。比如，我们需要一个东西，DI负责找创建并且提供给我们。</p><p><br/></p><p>为了而得到核心的AngularJS服务，只需要添加一个简单服务作为参数，AngularJS会侦测并且提供给你：</p><p><br/></p><p>function EditCtrl($scope, $location, $routeParams) {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp;// Something clever here...</p><p><br/></p><p>}</p><p><br/></p><p>你也可以定义自己的服务并且让它们注入：</p><p><br/></p><p>angular.module(&#39;MyServiceModule&#39;, []).</p><p><br/></p><p>&nbsp; &nbsp; factory(&#39;notify&#39;, [&#39;$window&#39;, function (win) {</p><p><br/></p><p>&nbsp; &nbsp; return function (msg) {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; win.alert(msg);</p><p><br/></p><p>&nbsp; &nbsp; };</p><p><br/></p><p>}]);</p><p><br/></p><p>function myController(scope, notifyService) {</p><p><br/></p><p>&nbsp; &nbsp; scope.callNotify = function (msg) {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; notifyService(msg);</p><p><br/></p><p>&nbsp; &nbsp; };</p><p><br/></p><p>}</p><p><br/></p><p>myController.$inject = [&#39;$scope&#39;, &#39;notify&#39;];&nbsp;</p><p><br/></p><p>3.5 特性五：指令（Directives）</p><p><br/></p><p>指令是我个人最喜欢的特性。你是不是也希望浏览器可以做点儿有意思的事情？那么AngularJS可以做到。</p><p><br/></p><p>指令可以用来创建自定义的标签。它们可以用来装饰元素或者操作DOM属性。可以作为标签、属性、注释和类名使用。</p><p><br/></p><p>这里是一个例子，它监听一个事件并且针对的更新它的$scope ，如下：</p><p><br/></p><p>myModule.directive(&#39;myComponent&#39;, function(mySharedService) {</p><p><br/></p><p>&nbsp; &nbsp; return {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; restrict: &#39;E&#39;,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; controller: function($scope, $attrs, mySharedService) {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $scope.$on(&#39;handleBroadcast&#39;, function() {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $scope.message = &#39;Directive: &#39; + mySharedService.message;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; });</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; },</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; replace: true,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; template: &#39;&lt;input&gt;&#39;</p><p><br/></p><p>&nbsp; &nbsp; };</p><p><br/></p><p>});</p><p><br/></p><p>然后，你可以使用这个自定义的directive来使用：</p><p><br/></p><p>&lt;my-component ng-model=&quot;message&quot;&gt;&lt;/my-component&gt;</p><p><br/></p><p>使用一系列的组件来创建你自己的应用将会让你更方便的添加，删除和更新功能。</p><p><br/></p><p>4 功能介绍</p><p>4.1数据绑定</p><p><br/></p><p>AngularJS的双向数据绑定，意味着你可以在Mode(JS)中改变数据，而这些变动立刻就会自动出现在View上，反之亦然。即：一方面可以做到model变化驱动了DOM中元素变化，另一方面也可以做到DOM元素的变化也会影响到Model。</p><p><br/></p><p>在我们使用jQuery的时候，代码中会大量充斥类似这样的语句：var val = $(‘#id’).val(); $(‘#id’).html(str);等等，即频繁的DOM操作（读取和写入），其实我们的最终目的并不是要操作DOM，而是要实现业务逻辑。ng的绑定将让你摆脱DOM操作，只要模板与数据通过声明进行了绑定，两者将随时保持同步，最新的数据会实时显示在页面中，页面中用户修改的数据也会实时被记录在数据模型中。</p><p><br/></p><p>从View到Controller再到View的数据交互（例01）：</p><p><br/></p><p>&lt;html ng-app=&quot;demoApp&quot;&gt;</p><p><br/></p><p>……</p><p><br/></p><p>&lt;input type=&quot;text&quot; ng-model=&quot;user.name&quot; placeholder=&quot;请输入名称&quot;/&gt;</p><p><br/></p><p>Hello, {{ user.name }}！</p><p><br/></p><p>……</p><p><br/></p><p>关键： ng-app 、 ng-model 和 { {user.name } }&nbsp;</p><p><br/></p><p>首先： &lt;html&gt;元素的ng-app属性。标识这个DOM里面的内容将启用AngularJS应用。</p><p><br/></p><p>其次：告诉AngularJS，对页面上的“user.name” 这个Model进行双向数据绑定。</p><p><br/></p><p>第三：告诉AngularJS，在“{{ user.name}}”这个指令模版上显示“user.name”这个Model的数据。</p><p><br/></p><p>从Server到Controller再到View的数据交互（例02）：</p><p><br/></p><p>&lt;html ng-app=&quot;demoApp&quot;&gt;</p><p><br/></p><p>……</p><p><br/></p><p>&lt;div &nbsp;ng-controller=&quot;demoController&quot;&gt;</p><p><br/></p><p>&lt;input type=&quot;text&quot; ng-model=&quot;user.name&quot; disabled=&quot;disabled&quot;/&gt;</p><p><br/></p><p>&lt;a href=&quot;javascript:void(0);&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;获取名字&lt;/a&gt;</p><p><br/></p><p>……</p><p><br/></p><p>demoApp.controller(&quot;demoController&quot;, function($http, $scope){</p><p><br/></p><p>$scope. getAjaxUser = function(){</p><p><br/></p><p>// $http.get({url:&quot;../xxx.action&quot;}).success(function(data){</p><p><br/></p><p>// $scope.user= data;</p><p><br/></p><p>// });</p><p><br/></p><p>$scope.user = {&quot;name&quot;:&quot;从JOSN中获取的名称&quot;,&quot;age&quot;:22};</p><p><br/></p><p>};</p><p><br/></p><p>});</p><p><br/></p><p>改变$scope中的user，View也会自动更新。</p><p><br/></p><p>4.2 scopes、module、controller&nbsp;</p><p><br/></p><p>4.2.1 scopes</p><p><br/></p><p>$scope是一个把view（一个DOM元素）连结到controller上的对象。在我们的MVC结构里，这个 $scope 将成为model，它提供一个绑定到DOM元素（以及其子元素）上的excecution context。</p><p><br/></p><p>尽管听起来有点复杂，但 $scope 实际上就是一个JavaScript对象，controller和view都可以访问它，所以我们可以利用它在两者间传递信息。在这个 $scope 对象里，我们既存储数据，又存储将要运行在view上的函数。</p><p><br/></p><p>每一个Angular应用都会有一个 $rootScope。这个 $rootScope 是最顶级的scope，它对应着含有 ng-app 指令属性的那个DOM元素。</p><p><br/></p><p>app.run(function($rootScope) { $rootScope.name = &quot;张三&quot;; });</p><p><br/></p><p>如果页面上没有明确设定 $scope ，Angular 就会把数据和函数都绑定到这里， 第一部分中的例子就是靠这一点成功运行的。</p><p><br/></p><p>这样，我们就可以在view的任何地方访问这个name属性，使用模版表达式{{}}，像这样：</p><p><br/></p><p>{{ name }} &nbsp;</p><p><br/></p><p>4.2.2 module</p><p><br/></p><p>首先需要明确一下模板的概念。在我还不知道有模板这个东西的时候，曾经用js拼接出很长的HTML字符串，然后append到页面中，这种方式想想真是又土又笨。后来又看到可以把HTML代码包裹在一个&lt;script&gt;标签中当作模板，然后按需要取来使用。</p><p><br/></p><p>在ng中，模板十分简单，它就是我们页面上的HTML代码，不需要附加任何额外的东西。在模板中可以使用各种指令来增强它的功能，这些指令可以让你把模板和数据巧妙的绑定起来。</p><p><br/></p><p>在&lt;html&gt;标签上多了一个属性ng-app=”MyApp”，它的作用就是用来指定ng的作用域是在&lt;html&gt;标签以内部分。在js中，我们调用angular对象的module方法来声明一个模块，模块的名字和ng-app的值对应。这样声明一下就可以让ng运行起来了。</p><p><br/></p><p>示例：</p><p><br/></p><p>&lt;html ng-app=&quot;demoApp&quot;&gt;</p><p><br/></p><p>var demoApp = angular.module(&#39;demoApp&#39;, []);</p><p><br/></p><p>4.2.3 ng-controller</p><p><br/></p><p>要明确创建一个$scope 对象，我们就要给DOM元素安上一个controller对象，使用的是ng-controller 指令属性：</p><p><br/></p><p>&lt;div ng-controller=&quot;MyController&quot;&gt; {{ person.name }} &lt;/div&gt; &nbsp;</p><p><br/></p><p>ng-controller指令给所在的DOM元素创建了一个新的$scope 对象，并将这个$scope 对象包含进外层DOM元素的$scope 对象里。在上面的例子里，这个外层DOM元素的$scope 对象，就是$rootScope 对象。这个scope链是这样的：</p><p><br/></p><p>&nbsp;</p><p><br/></p><p>&nbsp;</p><p><br/></p><p>所有scope都遵循原型继承（prototypal inheritance），这意味着它们都能访问父scope们。对任何属性和方法，如果AngularJS在当前scope上找不到，就会到父 scope上去找，如果在父scope上也没找到，就会继续向上回溯，一直到$rootScope 上。即如果controller是多层嵌套的，就会从最里面一直往外找，这个scope链是这样的：</p><p><br/></p><p>&nbsp;</p><p><br/></p><p>唯一的例外：有些指令属性可以选择性地创建一个独立的scope，让这个scope不继承它的父scope们，这个会在指令详解中说明。</p><p><br/></p><p>4.3 ajax</p><p><br/></p><p>$http 服务是AngularJS的核心服务之一，它帮助我们通过XMLHttpRequest对象或JSONP与远程HTTP服务进行交流。</p><p><br/></p><p>$http 服务是这样一个函数：它接受一个设置对象，其中指定了如何创建HTTP请求；它将返回一个承诺（*参考JavaScript异步编程的promise模式），其中提供两个方法： success方法和error方法。</p><p><br/></p><p>demoApp.controller(&quot;demoController&quot;, function($http, $scope){</p><p><br/></p><p>$scope. getAjaxUser = function(){</p><p><br/></p><p>$http.get({url:&quot;../xxx.action&quot;}).success(function(data){</p><p><br/></p><p>alert(data);</p><p><br/></p><p>}).error(function(){</p><p><br/></p><p>Alert(“出错了！”);</p><p><br/></p><p>});</p><p><br/></p><p>&nbsp;</p><p><br/></p><p>};</p><p><br/></p><p>});</p><p><br/></p><p>AngularJS的AJAX与jquery等框架的AJAX基本一致，这里就不多说了。</p><p><br/></p><p>4.4表达式</p><p><br/></p><p>ng中的表达式与javascript表达式类似但是不可以划等号，它是ng自己定义的一套模式。表达式可以作为指令的值，如ng-modle=”people.name”、ng-click=”showMe()”，看起来是如此像字符串，故而也叫字符串表达式。也可以在标记中使用表达式，如{{1+2}}，或者与过滤器一起使用{{1+2 | currency}}。在框架内部，字符串不会简单的使用eval()来执行，而是有一个专门的$parse服务来处理。在ng表达式中不可以使用循环语句、判断语句，事实上在模板中使用复杂的表达式也是一个不推荐的做法，这样视图与逻辑就混杂在一起了</p><p><br/></p><p>我们在使用其他模板库时，一般都会有模板的循环输出、分支输出、逻辑判断等类似的控制。</p><p><br/></p><p>要想理解指令属性的运作，我们必须先理解表达式。在之前的例子里我们已经见过表达式，例如 {{ user.name }}。</p><p><br/></p><p>请查看例03、例04、例05。</p><p><br/></p><p>{{ 8 + 1 }} 9</p><p><br/></p><p>{{ person }} {&quot;name&quot;:&quot;Ari Lerner&quot;}</p><p><br/></p><p>{{ 10 * 3.3 | currency }} $33.00</p><p><br/></p><p>表达式粗略来看有点像 eval(javascript) 的结果。它们会经过Angular.js的处理，从而拥有以下重要而独特的性质：</p><p><br/></p><p>l 所有表达式都在scope这个context里被执行，因此可以使用所有本地 $scope 中的变量。</p><p><br/></p><p>l 如果一个表达式的执行导致类型错误或引用错误，这些错误将不会被抛出。</p><p><br/></p><p>l 表达式里不允许任何控制函数流程的功能（如if/else等条件语句）</p><p><br/></p><p>l 表达式可接受一个或多个串联起来的过滤器。</p><p><br/></p><p>4.5过滤器</p><p><br/></p><p>过滤器（filter）正如其名，作用就是接收一个输入，通过某个规则进行处理，然后返回处理后的结果。主要用在数据的格式化上，例如获取一个数组中的子集，对数组中的元素进行排序等。过滤器通常是伴随标记来使用的，将你model中的数据格式化为需要的格式。表单的控制功能主要涉及到数据验证以及表单控件的增强。ng内置了一些过滤器，它们是：</p><p><br/></p><p>currency(货币)、date(日期)、filter(子串匹配)、json(格式化json对象)、limitTo(限制个数)、lowercase(小写)、uppercase(大写)、number(数字)、orderBy(排序)。</p><p><br/></p><p>4.5.1过滤器使用方式</p><p><br/></p><p>总共九种。除此之外还可以自定义过滤器，这个就强大了，可以满足任何要求的数据处理。Filter还是很简单的，需要明白的是内置的filter如何使用，以及自己如何定义一个filter。</p><p><br/></p><p>filter的两种使用方法：</p><p><br/></p><p>　　1. 在模板中使用filter</p><p><br/></p><p>　　我们可以直接在{{}}中使用filter，跟在表达式后面用 | 分割，语法如下：</p><p><br/></p><p>{{ expression | filter }}&nbsp;</p><p><br/></p><p>也可以多个filter连用，上一个filter的输出将作为下一个filter的输入：</p><p><br/></p><p>{{ expression | filter1 | filter2 | ... }}　　</p><p><br/></p><p>filter可以接收参数，参数用 : 进行分割，如下：</p><p><br/></p><p>{{ expression | filter:argument1:argument2:... }}　　</p><p><br/></p><p>除了对{{}}中的数据进行格式化，我们还可以在指令中使用filter，例如先对数组array进行过滤处理，然后再循环输出：</p><p><br/></p><p>&lt;span ng-repeat=&quot;a in array | filter &quot;&gt;　　</p><p><br/></p><p>2. 在controller和service中使用filter</p><p><br/></p><p>　　我们的js代码中也可以使用过滤器，方式就是我们熟悉的依赖注入，例如我要在controller中使用currency过滤器，只需将它注入到该controller中即可，代码如下：</p><p><br/></p><p>app.controller(&#39;testC&#39;,function($scope,currencyFilter){</p><p><br/></p><p>&nbsp; &nbsp; $scope.num = currencyFilter(123534); &nbsp;</p><p><br/></p><p>}　　</p><p><br/></p><p>在模板中使用{{num}}就可以直接输出$123,534.00了！在服务中使用filter也是同样的道理。</p><p><br/></p><p>　　如果你要在controller中使用多个filter，并不需要一个一个注入吗，ng提供了一个$filter服务可以来调用所需的filter，你只需注入一个$filter就够了，使用方法如下：</p><p><br/></p><p>app.controller(&#39;testC&#39;,function($scope,$filter){</p><p><br/></p><p>$scope.num = $filter(&#39;currency&#39;)(123534);　　</p><p><br/></p><p>$scope.date = $filter(&#39;date&#39;)(new Date()); &nbsp;</p><p><br/></p><p>}　　</p><p><br/></p><p>可以达到同样的效果。好处是你可以方便使用不同的filter了。</p><p><br/></p><p>4.5.2 ng的内置过滤器</p><p><br/></p><p>ng内置了九种过滤器，使用方法都非常简单，看文档即懂。不过为了以后不去翻它的文档，我在这里还是做一个详细的记录。</p><p><br/></p><p>currency(货币)、date(日期)、filter(子串匹配)、json(格式化json对象)、limitTo(限制个数)、lowercase(小写)、uppercase(大写)、number(数字)、orderBy(排序)</p><p><br/></p><p>1. currency (货币处理)</p><p><br/></p><p>　　使用currency可以将数字格式化为货币，默认是美元符号，你可以自己传入所需的符号，例如我传入人民币：</p><p><br/></p><p>{{num | currency : &#39;￥&#39;}}　　</p><p><br/></p><p>2. date (日期格式化)</p><p><br/></p><p>　　原生的js对日期的格式化能力有限，ng提供的date过滤器基本可以满足一般的格式化要求。用法如下：</p><p><br/></p><p>{{date | date : &#39;yyyy-MM-dd hh:mm:ss EEEE&#39;}}　　</p><p><br/></p><p>参数用来指定所要的格式，y M d h m s E 分别表示 年 月 日 时 分 秒 星期，你可以自由组合它们。也可以使用不同的个数来限制格式化的位数。另外参数也可以使用特定的描述性字符串，例如“shortTime”将会把时间格式为12:05 pm这样的。ng提供了八种描述性的字符串，个人觉得这些有点多余，我完全可以根据自己的意愿组合出想要的格式，不愿意去记这么多单词~</p><p><br/></p><p>3. filter(匹配子串)</p><p><br/></p><p>　　这个名叫filter的filter。用来处理一个数组，然后可以过滤出含有某个子串的元素，作为一个子数组来返回。可以是字符串数组，也可以是对象数组。如果是对象数组，可以匹配属性的值。它接收一个参数，用来定义子串的匹配规则。下面举个例子说明一下参数的用法，我用现在特别火的几个孩子定义了一个数组：</p><p><br/></p><p>$scope.childrenArray = [</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; {name:&#39;kimi&#39;,age:3},</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; {name:&#39;cindy&#39;,age:4},</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; {name:&#39;anglar&#39;,age:4},</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; {name:&#39;shitou&#39;,age:6},</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; {name:&#39;tiantian&#39;,age:5}</p><p><br/></p><p>];</p><p><br/></p><p>$scope.func = function(e){return e.age&gt;4;}{{ childrenArray | filter : &#39;a&#39; }} //匹配属性值中含有a的</p><p><br/></p><p>{{ childrenArray | filter : 4 }} &nbsp;//匹配属性值中含有4的</p><p><br/></p><p>{{ childrenArray | filter : {name : &#39;i&#39;} }} //参数是对象，匹配name属性中含有i的</p><p><br/></p><p>{{childrenArray | filter : func }} &nbsp;//参数是函数，指定返回age&gt;4的　　</p><p><br/></p><p>4. json(格式化json对象)</p><p><br/></p><p>　　json过滤器可以把一个js对象格式化为json字符串，没有参数。这东西有什么用呢，我一般也不会在页面上输出一个json串啊，官网说它可以用来进行调试，嗯，是个不错的选择。或者，也可以用在js中使用，作用就和我们熟悉的JSON.stringify()一样。用法超级简单：</p><p><br/></p><p>{{ jsonTest | json}}</p><p><br/></p><p>5. limitTo(限制数组长度或字符串长度)</p><p><br/></p><p>　　limitTo过滤器用来截取数组或字符串，接收一个参数用来指定截取的长度，如果参数是负值，则从数组尾部开始截取。个人觉得这个filter有点鸡肋，首先只能从数组或字符串的开头/尾部进行截取，其次，js原生的函数就可以代替它了，看看怎么用吧：</p><p><br/></p><p>{{ childrenArray | limitTo : 2 }} &nbsp;//将会显示数组中的前两项　　</p><p><br/></p><p>6. lowercase(小写)</p><p><br/></p><p>　　把数据转化为全部小写。太简单了，不多解释。同样是很鸡肋的一个filter，没有参数，只能把整个字符串变为小写，不能指定字母。怎么用我都懒得写了。</p><p><br/></p><p>7. uppercase(大写)</p><p><br/></p><p>　　同上。</p><p><br/></p><p>8. number(格式化数字)</p><p><br/></p><p>　　number过滤器可以为一个数字加上千位分割，像这样，123,456,789。同时接收一个参数，可以指定float类型保留几位小数：</p><p><br/></p><p>{{ num | number : 2 }}　　</p><p><br/></p><p>9. orderBy(排序)</p><p><br/></p><p>　　orderBy过滤器可以将一个数组中的元素进行排序，接收一个参数来指定排序规则，参数可以是一个字符串，表示以该属性名称进行排序。可以是一个函数，定义排序属性。还可以是一个数组，表示依次按数组中的属性值进行排序（若按第一项比较的值相等，再按第二项比较），还是拿上面的孩子数组举例：</p><p><br/></p><p>&lt;div&gt;{{ childrenArray | orderBy : &#39;age&#39; }}&lt;/div&gt; &nbsp; &nbsp; &nbsp;//按age属性值进行排序，若是-age，则倒序</p><p><br/></p><p>&lt;div&gt;{{ childrenArray | orderBy : orderFunc }}&lt;/div&gt; &nbsp; //按照函数的返回值进行排序</p><p><br/></p><p>&lt;div&gt;{{ childrenArray | orderBy : [&#39;age&#39;,&#39;name&#39;] }}&lt;/div&gt; &nbsp;//如果age相同，按照name进行排序　　内置的过滤器介绍完了，写的我都快睡着了。。。正如你所看到的，ng内置的过滤器也并不是万能的，事实上好多都比较鸡肋。更个性化的需求就需要我们来定义自己的过滤器了，下面来看看如何自定义过滤器。</p><p><br/></p><p>4.5.3自定义过滤器及示例</p><p><br/></p><p>　　filter的自定义方式也很简单，使用module的filter方法，返回一个函数，该函数接收</p><p><br/></p><p>输入值，并返回处理后的结果。话不多说，我们来写一个看看。比如我需要一个过滤器，它可以返回一个数组中下标为奇数的元素，代码如下：</p><p><br/></p><p>app.filter(&#39;odditems&#39;,function(){</p><p><br/></p><p>&nbsp; &nbsp; return function(inputArray){</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; var array = [];</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; for(var i=0;i&lt;inputArray.length;i++){</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(i%2!==0){</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; array.push(inputArray[i]);</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; return array;</p><p><br/></p><p>&nbsp; &nbsp; }</p><p><br/></p><p>});　　</p><p><br/></p><p>格式就是这样，你的处理逻辑就写在内部的那个闭包函数中。你也可以让自己的过滤器接收参数，参数就定义在return的那个函数中，作为第二个参数，或者更多个参数也可以。</p><p><br/></p><p>自定义过滤器实例（例04）：</p><p><br/></p><p>/* View html */</p><p><br/></p><p>First name：&lt;input ng-model=&quot;user.firstName&quot;/&gt;&lt;br/&gt;</p><p><br/></p><p>Last &nbsp;name：&lt;input ng-model=&quot;user.lastName&quot;/&gt; &lt;br/&gt;</p><p><br/></p><p>First name：{{user.firstName}} &nbsp; &nbsp; &nbsp;Last &nbsp;name：{{user.lastName}} &lt;br/&gt;</p><p><br/></p><p>Fullname：{{user | flFullname}}&lt;br/&gt;</p><p><br/></p><p>Fullname：{{user | flFullname:&quot;－&quot;}}&lt;br/&gt;</p><p><br/></p><p>Fullname：{{user | flFullname:&quot;•&quot; | uppercase }}</p><p><br/></p><p>/* Controller js */</p><p><br/></p><p>demoApp.filter(&quot;flFullname&quot;, function() {</p><p><br/></p><p>&nbsp; &nbsp; return function(user, sep) {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; sep = sep || &quot; &quot;;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; user = user || {};</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; fullName = &quot;&quot;;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; if(user.firstName){fullName += user.firstName;}</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; if(user.lastName){fullName = fullName + sep + user.lastName;}</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; if(fullName &amp;&amp; fullName.length&gt;0){return fullName;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; }else{return &quot;&quot;;}</p><p><br/></p><p>&nbsp; &nbsp; };</p><p><br/></p><p>});</p><p><br/></p><p>4.6指令(directive)</p><p><br/></p><p>　　通过使用模板，我们可以把model和controller中的数据组装起来呈现给浏览器，还可以通过数据绑定，实时更新视图，让我们的页面变成动态的。</p><p><br/></p><p>　 模板中可以使用的东西包括以下四种：</p><p><br/></p><p>1.指令(directive)：ng提供的或者自定义的标签和属性，用来增强HTML表现力；</p><p><br/></p><p>2.标记(markup)：即双大括号{{}}，可将数据单向绑定到HTML中；</p><p><br/></p><p>3.过滤器(filter)：用来格式化输出数据；</p><p><br/></p><p>4.表单控制：用来增强表单的验证功能。</p><p><br/></p><p>其中，指令无疑是使用量最大的，ng内置了很多指令用来控制模板，如ng-repeat，ng-class，也有很多指令来帮你完成业务逻辑，如ng-controller,ng-model。</p><p><br/></p><p>指令的几种使用方式如下：</p><p><br/></p><p>l 作为标签：&lt;my-dir&gt;&lt;/my-dir&gt;</p><p><br/></p><p>l 作为属性：&lt;span my-dir=&quot;exp&quot;&gt;&lt;/span&gt;</p><p><br/></p><p>l 作为注释：&lt;!-- directive: my-dir exp --&gt;</p><p><br/></p><p>l 作为类名：&lt;span class=&quot;my-dir: exp;&quot;&gt;&lt;/span&gt;</p><p><br/></p><p>其实常用的就是作为标签和属性。</p><p><br/></p><p>4.6.1样式相关的指令</p><p><br/></p><p>　　既然模板就是普通的HTML，那我首要关心的就是样式的控制，元素的定位、字体、背景色等等如何可以灵活控制。下面来看看常用的样式控制指令。</p><p><br/></p><p>1. ng-class</p><p><br/></p><p>　　 ng-class用来给元素绑定类名，其表达式的返回值可以是以下三种：</p><p><br/></p><p>l 类名字符串，可以用空格分割多个类名，如’redtext boldtext’；</p><p><br/></p><p>l 类名数组，数组中的每一项都会层叠起来生效；</p><p><br/></p><p>l 一个名值对应的map，其键值为类名，值为boolean类型，当值为true时，该类会被加在元素上。</p><p><br/></p><p>　　下面来看一个使用map的例子：</p><p><br/></p><p>ng-class测试</p><p><br/></p><p>红色 加粗 删除线&nbsp;</p><p><br/></p><p>map:{redtext:{{red}}, boldtext:{{bold}}, striketext:{{strike}}}</p><p><br/></p><p>　　如果你想拼接一个类名出来，可以使用插值表达式，如：</p><p><br/></p><p>　　&lt;div class=”{{style}}text”&gt;字体样式测试&lt;/div&gt;</p><p><br/></p><p>　　然后在controller中指定style的值：</p><p><br/></p><p>　　$scope.style = ‘red’;</p><p><br/></p><p>　　注意我用了class而不是ng-class，这是不可以对换的，官方的文档也未做说明，姑且认为这是ng的语法规则吧。</p><p><br/></p><p>　　与ng-class相近的，ng还提供了ng-class-odd、ng-class-even两个指令，用来配合ng-repeat分别在奇数列和偶数列使用对应的类。这个用来在表格中实现隔行换色再方便不过了。</p><p><br/></p><p>2. ng-style</p><p><br/></p><p>　　ng-style用来绑定元素的css样式，其表达式的返回值为一个js对象，键为css样式名，值为该样式对应的合法取值。用法比较简单：</p><p><br/></p><p>&lt;div ng-style=&quot;{color:&#39;red&#39;}&quot;&gt;ng-style测试&lt;/div&gt;</p><p><br/></p><p>&lt;div ng-style=&quot;style&quot;&gt;ng-style测试&lt;/div&gt;</p><p><br/></p><p>$scope.style = {color:&#39;red&#39;};　　</p><p><br/></p><p>3. ng-show，ng-hide</p><p><br/></p><p>　　　对于比较常用的元素显隐控制，ng也做了封装，ng-show和ng-hide的值为boolean类型的表达式，当值为true时，对应的show或hide生效。框架会用display:block和display:none来控制元素的显隐。</p><p><br/></p><p>4.6.2表单控件功能相关指令</p><p><br/></p><p>　　对于常用的表单控件功能，ng也做了封装，方便灵活控制。</p><p><br/></p><p>　　ng-checked控制radio和checkbox的选中状态</p><p><br/></p><p>　　ng-selected控制下拉框的选中状态</p><p><br/></p><p>　　ng-disabled控制失效状态</p><p><br/></p><p>　　ng-multiple控制多选</p><p><br/></p><p>　　ng-readonly控制只读状态</p><p><br/></p><p>　　以上指令的取值均为boolean类型，当值为true时相关状态生效，道理比较简单就不多做解释。注意： 上面的这些只是单向绑定，即只是从数据到模板，不能反作用于数据。要双向绑定，还是要使用 ng-model 。</p><p><br/></p><p>4.6.3事件绑定相关指令</p><p><br/></p><p>事件绑定是javascrpt中比较重要的一部分内容，ng对此也做了详细的封装，正如我们之前使用过的ng-click一样，事件的指令如下：</p><p><br/></p><p>ng-click</p><p><br/></p><p>　　ng-change</p><p><br/></p><p>　　ng-dblclick</p><p><br/></p><p>　　ng-mousedown</p><p><br/></p><p>　　ng-mouseenter</p><p><br/></p><p>　　ng-mouseleave</p><p><br/></p><p>　　ng-mousemove</p><p><br/></p><p>　　ng-mouseover</p><p><br/></p><p>　　ng-mouseup</p><p><br/></p><p>　　ng-submit</p><p><br/></p><p>　　事件绑定指令的取值为函数，并且需要加上括号，例如：</p><p><br/></p><p>&lt;select ng-change=”change($event)”&gt;&lt;/select&gt;　　</p><p><br/></p><p>然后在controller中定义如下：</p><p><br/></p><p>$scope.change = function($event){</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;alert($event.target);</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//……………………</p><p><br/></p><p>}　　</p><p><br/></p><p>在模板中可以用变量$event将事件对象传递到controller中。</p><p><br/></p><p>对于ng的这种设计，一些人有所质疑，视图与事件绑定混在一起到底好不好？我们不是要讲究视图与逻辑分离吗？如此一来，把事件的绑定又变回了内联的，岂不是历史的倒退。我也一样对此表示不解，因为不写onclick已经很多年。。。但既然已经存在了，我们不妨往合理的方向上想一想，或许ng的设计者压根就不想让模板成为单纯的视图层，本来就是想增强HTML，让它有一点业务能力。这么想的话似乎也能想通，好吧，先欺骗一下自己吧~</p><p><br/></p><p>4.6.4特殊的ng-src和ng-href</p><p><br/></p><p>在说明这两个指令的特殊之前，需要先了解一下ng的启动及执行过程，如下图：</p><p><br/></p><p>&nbsp;</p><p><br/></p><p>1) 浏览器加载静态HTML文件并解析为DOM；</p><p><br/></p><p>　　2) 浏览器加载angular.js文件；</p><p><br/></p><p>　　3) angular监听DOMContentLoaded 事件，监听到时开始启动；</p><p><br/></p><p>　　4) angular寻找ng-app指令，确定作用范围；</p><p><br/></p><p>　　5) 找到app中定义的Module使用$injector服务进行依赖注入；</p><p><br/></p><p>　　6) 根据$injector服务创建$compile服务用于编译；</p><p><br/></p><p>　　7) $compile服务编译DOM中的指令、过滤器等；</p><p><br/></p><p>　　8) 使用ng-init指令，将作用域中的变量进行替换；</p><p><br/></p><p>　　9) 最后生成了我们在最终视图。</p><p><br/></p><p>　　可以看到，ng框架是在DOMcontent加载完毕后才开始发挥作用。假如我们模板中有一张图片如下：</p><p><br/></p><p>　　&lt;img src=&quot;http://m.cnblogs.com/142260/”{{imgUrl}}” /&gt;</p><p><br/></p><p>　　那么在页面开始加载到ng编译完成之前，页面上会一直显示一张错误的图片，因为路径{{imgUrl}}还未被替换。</p><p><br/></p><p>　　为了避免这种情况，我们使用ng-src指令，这样在路径被正确得到之前就不会显示找不到图片。同理，&lt;a&gt;标签的href属性也需要换成ng-href，这样页面上就不会先出现一个地址错误的链接。</p><p><br/></p><p>顺着这个思路再多想一点，我们在模板中使用{{}}显示数据时，在ng编译完成之前页面上岂不是会显示出大括号及里面的表达式？确实是这样。为了避免这个，ng中有一个与{{}}等同的指令:ng-bind，同样用于单向绑定，在页面刚加载的时候就不会显示出对用户无用的数据了。尽管这样你可能不但没舒心反而更纠结了，{{}}那么好用易理解，还不能用了不成？好消息是我们依然可以使用。因为我编写的是单页面应用，页面只会在加载index.html的时</p><p><br/></p><p>候出这个问题，只需在index.html中的模板中换成ng-bind就行。其他的模板是我们动态加载的，就可以放心使用{{}}了。</p><p><br/></p><p>4.6.5 自定义指令示例</p><p><br/></p><p>下面我们来解析下指令的例子（例07）。</p><p><br/></p><p>1.首先，我们定义一个名为userInfo的指令：</p><p><br/></p><p>demoApp.directive(&#39;userInfo&#39;,function(){</p><p><br/></p><p>return {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; restrict : &#39;E&#39;,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; templateUrl : &#39;userInfoTemplate.html&#39;,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; replace : true,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; transclude : true,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; scope : {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mytitle : &#39;=etitle&#39;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; },</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; link : function(scope,element,attrs){</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scope.showText = false;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scope.toggleText = function(){</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scope.showText = ! scope.showText;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p><br/></p><p>&nbsp; &nbsp; };</p><p><br/></p><p>}) &nbsp;</p><p><br/></p><p>Restrict为&#39;E&#39;：用作标签；replace为true：用模板替换当前标签；transclude为true：将当前元素的内容转移到模板中；scope 为 {mytitle : &#39;=etitle&#39;}：定义一个名为mytitle的MODEL，其值指向当前元素的etitle属性；templateUrl为&#39;userInfoTemplate.html&#39;：模板内容为ng-template定义ID为userInfoTemplate.html的内容；link：指定所包含的行为。其具体的说明及其他参数，请参考：6.2指令详解。</p><p><br/></p><p>2. userInfoTemplate.html模板为：</p><p><br/></p><p>&lt;script type=&quot;text/ng-template&quot; id=&quot;userInfoTemplate.html&quot;&gt;</p><p><br/></p><p>&lt;div class=&quot;mybox&quot;&gt;</p><p><br/></p><p>&lt;div class=&quot;mytitle&quot; style=&quot;cursor: pointer;&quot; ng-click=&quot;toggleText()&quot;&gt;</p><p><br/></p><p>{ {mytitle} }</p><p><br/></p><p>&lt;/div&gt;</p><p><br/></p><p>&lt;div ng-transclude ng-show=&quot;showText&quot;&gt;</p><p><br/></p><p>&lt;/div&gt;</p><p><br/></p><p>&lt;/div&gt;</p><p><br/></p><p>&lt;/script&gt;</p><p><br/></p><p>将当前元素的内容添加到有ng-transclude属性的这个DIV下，默认是隐藏的。</p><p><br/></p><p>3.Controller信息：</p><p><br/></p><p>demoApp.controller(&quot;test7Controller&quot;, function($scope){</p><p><br/></p><p>$scope.title = &#39;个人简介&#39;;</p><p><br/></p><p>$scope.text = &#39;大家好，我正在研究AngularJs，欢迎大家与我交流。&#39;;</p><p><br/></p><p>$scope.updateInfo = function (){</p><p><br/></p><p>$scope.title = &#39;个人信息&#39;;</p><p><br/></p><p>$scope.text = &#39;大家好，今天天气真好！&#39;;</p><p><br/></p><p>}</p><p><br/></p><p>});</p><p><br/></p><p>4.指令使用方式（View信息）为：</p><p><br/></p><p>&lt;user-info etitle=&quot;title&quot;&gt;{ {text} }&lt;/user-info&gt;</p><p><br/></p><p>Etitle指向Controller中的$scope.title。注意命名方式：指令名为userInfo，对应的标签为user-info。</p><p><br/></p><p>4.7服务（service）</p><p><br/></p><p>4.7.1服务介绍</p><p><br/></p><p>　　服务这个概念其实并不陌生，在其他语言中如java便有这样的概念，其作用就是对外提供某个特定的功能，如消息服务，文件压缩服务等，是一个独立的模块。ng的服务是这样定义的：</p><p><br/></p><p>Angular services are singletons objects or functions that carry out specific tasks common to web apps.</p><p><br/></p><p>它是一个单例对象或函数，对外提供特定的功能。</p><p><br/></p><p>首先是一个单例，即无论这个服务被注入到任何地方，对象始终只有一个实例。</p><p><br/></p><p>其次这与我们自己定义一个function然后在其他地方调用不同，因为服务被定义在一个模块中，所以其使用范围是可以被我们管理的。ng的避免全局变量污染意识非常强。</p><p><br/></p><p>　　ng提供了很多内置的服务，可以到API中查看http://docs.angularjs.org/api/。知道了概念，我们来拉一个service出来溜溜，看看到底是个什么用法。　　</p><p><br/></p><p>　　我们在controller中直接声明$location服务，这依靠ng的依赖注入机制。$location提供地址栏相关的服务，我们在此只是简单的获取当前的地址。</p><p><br/></p><p>　　服务的使用是如此简单，我们可以把服务注入到controller、指令或者是其他服务中。</p><p><br/></p><p>4.7.2自定义服务</p><p><br/></p><p>　　如同指令一样，系统内置的服务以$开头，我们也可以自己定义一个服务。定义服务的方式有如下几种：</p><p><br/></p><p>l 使用系统内置的$provide服务；</p><p><br/></p><p>l 使用Module的factory方法；</p><p><br/></p><p>l 使用Module的service方法。</p><p><br/></p><p>　　下面通过一个小例子来分别试验一下。我们定义一个名为remoteData服务，它可以从远程获取数据，这也是我们在程序中经常使用的功能。不过我这里没有远程服务器，就写死一点数据模拟一下。</p><p><br/></p><p>//使用$provide来定义</p><p><br/></p><p>var app = angular.module(&#39;MyApp&#39;, [], function($provide) {</p><p><br/></p><p>&nbsp; &nbsp; $provide.factory(&#39;remoteData&#39;, function() {</p><p><br/></p><p>&nbsp;var data = {name:&#39;n&#39;,value:&#39;v&#39;};</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; return data;</p><p><br/></p><p>&nbsp; &nbsp; });</p><p><br/></p><p>});</p><p><br/></p><p>//使用factory方法</p><p><br/></p><p>app.factory(&#39;remoteData&#39;,function(){</p><p><br/></p><p>&nbsp; &nbsp; var data = {name:&#39;n&#39;,value:&#39;v&#39;};</p><p><br/></p><p>&nbsp; &nbsp; return data;</p><p><br/></p><p>});</p><p><br/></p><p>//使用service方法</p><p><br/></p><p>app.service(&#39;remoteData&#39;,function(){</p><p><br/></p><p>&nbsp; &nbsp; this.name = &#39;n&#39;;</p><p><br/></p><p>&nbsp; &nbsp; this.value = &#39;v&#39;;</p><p><br/></p><p>});</p><p><br/></p><p>Module的factory和$provide的factory方法是一模一样的，从官网文档看它们其实就是一回事。至于Module内部是如何调用的，我此处并不打算深究，我只要知道怎么用就好了。</p><p><br/></p><p>再看Module的service方法，它没有return任何东西，是因为service方法本身返回一个构造器，系统会自动使用new关键字来创建出一个对象。所以我们看到在构造器函数内可以使用this，这样调用该服务的地方便可以直接通过remoteData.name来访问数据了。</p><p><br/></p><p>4.7.3管理服务的依赖关系</p><p><br/></p><p>　　服务与服务中间可以有依赖关系，例如我们这里定义一个名为validate的服务，它的作用是验证数据是否合法，它需要依赖我们从远程获取数据的服务remoteData。代码如下：</p><p><br/></p><p>&nbsp;　 在factory的参数中，我们可以直接传入服务remoteData，ng的依赖注入机制便帮我们做好了其他工作。不过一定要保证这个参数的名称与服务名称一致，ng是根据名称来识别的。若参数的名次与服务名称不一致，你就必须显示的声明一下，方式如下：</p><p><br/></p><p>app.factory(&#39;validate&#39;,[&#39;remoteData&#39;,function(remoteDataService){</p><p><br/></p><p>&nbsp; &nbsp; return function(){</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; if(remoteDataService.name==&#39;n&#39;){</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; alert(&#39;验证通过&#39;);</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p><br/></p><p>&nbsp; &nbsp; };</p><p><br/></p><p>}]);　　</p><p><br/></p><p>我们在controller中注入服务也是同样的道理，使用的名称需要与服务名称一致才可以正确注入。否则，你必须使用$inject来手动指定注入的服务。比如：</p><p><br/></p><p>function testC(scope,rd){</p><p><br/></p><p>&nbsp; &nbsp; scope.getData = function(){</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; alert(&#39;name：&#39;+rd.name+&#39; &nbsp; value：&#39;+rd.value);</p><p><br/></p><p>&nbsp; &nbsp; }</p><p><br/></p><p>}</p><p><br/></p><p>testC.$inject = [&#39;$scope&#39;,&#39;remoteData&#39;];</p><p><br/></p><p>&nbsp;</p><p><br/></p><p>　　在controller中注入服务，也可以在定义controller时使用数组作为第二个参数，在此处</p><p><br/></p><p>把服务注入进去，这样在函数体中使用不一致的服务名称也是可以的，不过要确保注入的顺序是一致的，如：</p><p><br/></p><p>app.controller(&#39;testC&#39;,[&#39;$scope&#39;,&#39;remoteData&#39;,function($scope,rd){</p><p><br/></p><p>&nbsp; &nbsp; $scope.getData = function(){</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; alert(&#39;name：&#39;+rd.name+&#39; &nbsp; value：&#39;+rd.value);</p><p><br/></p><p>&nbsp; &nbsp; }</p><p><br/></p><p>}]);&nbsp;</p><p><br/></p><p>4.7.4 自定义服务示例</p><p><br/></p><p>接下来让我们看下例子（例08 自定义服务）代码，自定义userService服务：</p><p><br/></p><p>demoApp.factory(&#39;userService&#39;, [&#39;$http&#39;, function($http) {</p><p><br/></p><p>var doGetUser = function(userId, path) {</p><p><br/></p><p>//return $http({</p><p><br/></p><p>//method: &#39;JSONP&#39;,</p><p><br/></p><p>//url: path</p><p><br/></p><p>//});</p><p><br/></p><p>/*手动指定数据*/</p><p><br/></p><p>var data = {userId:&quot;woshishui&quot;,userName:&quot;我是谁&quot;,userInfo:&quot;我是谁！我是谁！&quot;};;</p><p><br/></p><p>if(userId==&#39;zhangsan&#39;){</p><p><br/></p><p>data = {userId:&quot;zhangsan&quot;,userName:&quot;张三&quot;,userInfo:&quot;我是张三，我为自己&quot;};</p><p><br/></p><p>}else if(userId==&#39;lisi&#39;){</p><p><br/></p><p>data = {userId:&quot;lisi&quot;,userName:&quot;李四&quot;,userInfo:&quot;我是李四，我为卿狂！&quot;};</p><p><br/></p><p>}</p><p><br/></p><p>return data;</p><p><br/></p><p>}</p><p><br/></p><p>return {</p><p><br/></p><p>/*userService对外暴露的函数，可有多个*/</p><p><br/></p><p>getUser: function(userId) {&nbsp;</p><p><br/></p><p>return doGetUser(userId, &#39;../xxx/xxx.action&#39;);&nbsp;</p><p><br/></p><p>}</p><p><br/></p><p>};</p><p><br/></p><p>}]);</p><p><br/></p><p>我们创建了一个只有一个方法的userService，getUser为这个服务从后台获取用户信息的函数，并且对外暴露。当然，由于这是一个静态的例子，无法访问后台，那么我们便制定其返回的数据。</p><p><br/></p><p>然后我们把这个服务添加到我们的controller中。我们建立一个controller并加载（或者注入）userService作为运行时依赖，我们把service的名字作为参数传递给controller 函数：</p><p><br/></p><p>demoApp.controller(&quot;test8Controller&quot;, function($scope,userService){</p><p><br/></p><p>/*文章信息*/</p><p><br/></p><p>$scope.articles = [{</p><p><br/></p><p>title : &quot;爱飞像风&quot;,</p><p><br/></p><p>userId : &quot;zhangsan&quot;,</p><p><br/></p><p>userName : &quot;张三&quot;</p><p><br/></p><p>},{</p><p><br/></p><p>title : &quot;无法停止的雨&quot;,</p><p><br/></p><p>userId : &quot;lisi&quot;,</p><p><br/></p><p>userName : &quot;李四&quot;</p><p><br/></p><p>}];</p><p><br/></p><p>$scope.showUserInfo = false;//显示作者详细信息开关</p><p><br/></p><p>$scope.currentUser = {}; //当前选中的作者</p><p><br/></p><p>$scope.getUserInfo = function(userId){</p><p><br/></p><p>$scope.currentUser = userService.getUser(userId);</p><p><br/></p><p>//调用 userService的getUser函数</p><p><br/></p><p>$scope.showUserInfo = true;</p><p><br/></p><p>setTimeout(function(){//定时器：隐藏作者详细信息</p><p><br/></p><p>$scope.showUserInfo = false;</p><p><br/></p><p>},3000);</p><p><br/></p><p>}</p><p><br/></p><p>});</p><p><br/></p><p>我们的userService注入到我们的test8Controller后，我们就可以像使用其他服务（我们前面提到的$http服务）一样的使用userService了。</p><p><br/></p><p>相关的HTML代码如下：</p><p><br/></p><p>/* View HTML*/</p><p><br/></p><p>&lt;tr ng-repeat=&quot;article_ in articles&quot;&gt;</p><p><br/></p><p>&lt;td&gt;</p><p><br/></p><p>{{article_.title}}</p><p><br/></p><p>&lt;/td&gt;</p><p><br/></p><p>&lt;td&gt;</p><p><br/></p><p>&lt;a href=&quot;javascript:void(0);&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;</p><p><br/></p><p>&lt;/td&gt;</p><p><br/></p><p>&lt;/tr&gt;</p><p><br/></p><p>......</p><p><br/></p><p>&lt;div ng-show=&quot;showUserInfo&quot;&gt;</p><p><br/></p><p>用户ID：{{currentUser.userId}}&lt;br/&gt;</p><p><br/></p><p>用户名：{{currentUser.userName}}&lt;br/&gt;</p><p><br/></p><p>用户简介：{{currentUser.userInfo}}&lt;br/&gt;</p><p><br/></p><p>&lt;/div&gt;</p><p><br/></p><p>4.8依赖注入DI</p><p><br/></p><p>通过依赖注入，ng想要推崇一种声明式的开发方式，即当我们需要使用某一模块或服务时，不需要关心此模块内部如何实现，只需声明一下就可以使用了。在多处使用只需进行多次声明，大大提高可复用性。</p><p><br/></p><p>　　比如我们的controller，在定义的时候用到一个$scope参数。</p><p><br/></p><p>app.controller(&#39;testC&#39;,function($scope){});　　</p><p><br/></p><p>如果我们在此处还需操作其他的东西，比如与浏览器地址栏进行交互。我们只需再多添</p><p><br/></p><p>一个参数$location进去：</p><p><br/></p><p>app.controller(&#39;testC&#39;,function($scope,$location){});　　</p><p><br/></p><p>这样便可以通过$location来与地址栏进行交互了，我们仅仅是声明了一下，所需的其他代码，框架已经帮我们注入了。我们很明显的感觉到了这个函数已经不是常规意义上的javascript函数了，在常规的函数中，把形参换一个名字照样可以运行，但在此处若是把$scope换成别的名字，程序便不能运行了。因为这是已经定义好的服务名称。</p><p><br/></p><p>这便是依赖注入机制。顺理成章的推断，我们可以自己定义模块和服务，然后在需要的地方进行声明，由框架来替我们注入。</p><p><br/></p><p>来看下我们如何定义一个服务：</p><p><br/></p><p>app.factory(&#39;tpls&#39;,function(){</p><p><br/></p><p>&nbsp; &nbsp; return [&#39;tpl1&#39;,&#39;tpl2&#39;,&#39;tpl3&#39;,&#39;tpl4&#39;];</p><p><br/></p><p>});　　</p><p><br/></p><p>看上去相当简单，是因为我在这里仅仅是直接返回一个数组。在实际应用中，这里应该是需要向服务器发起一个请求，来获取到这些模板们。服务的定义方式有好几种，包括使用provider方法、使用factory方法，使用service方法。它们之间的区别暂且不关心。我们现在只要能创建一个服务出来就可以了。我使用了factory方法。一个需要注意的地方是，框架提供的服务名字都是由$开头的，所以我们自己定义的最好不要用$开头，防止发生命名冲突。</p><p><br/></p><p>定义好一个服务后，我们就可以在控制器中声明使用了，如下：</p><p><br/></p><p>app.controller(&#39;testC&#39;,function($scope,tpls){</p><p><br/></p><p>&nbsp; &nbsp; $scope.question = questionModel;</p><p><br/></p><p>&nbsp; &nbsp; $scope.nowTime = new Date().valueOf();</p><p><br/></p><p>&nbsp; &nbsp; $scope.templates = tpls; //赋值到$scope中</p><p><br/></p><p>&nbsp; &nbsp; $scope.addOption = function(){</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; var o = {content:&#39;&#39;};</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; $scope.question.options.push(o);</p><p><br/></p><p>&nbsp; &nbsp; };</p><p><br/></p><p>&nbsp; &nbsp; $scope.delOption = function(index){</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; $scope.question.options.splice(index,1);</p><p><br/></p><p>&nbsp; &nbsp; };</p><p><br/></p><p>});　　</p><p><br/></p><p>此时，若在模板中书写如下代码，我们便可以获取到服务tpls所提供的数据了：</p><p><br/></p><p>模板:</p><p><br/></p><p>&lt;a href=&quot;javascript:void(0);&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;</p><p><br/></p><p>4.9路由（route）</p><p><br/></p><p>在谈路由机制前有必要先提一下现在比较流行的单页面应用，就是所谓的single page APP。为了实现无刷新的视图切换，我们通常会用ajax请求从后台取数据，然后套上HTML模板渲染在页面上，然而ajax的一个致命缺点就是导致浏览器后退按钮失效，尽管我们可以在页面上放一个大大的返回按钮，让用户点击返回来导航，但总是无法避免用户习惯性的点后退。解决此问题的一个方法是使用hash，监听hashchange事件来进行视图切换，另一个方法是用HTML5的history API，通过pushState()记录操作历史，监听popstate事件来进行视图切换，也有人把这叫pjax技术。基本流程如下：</p><p><br/></p><p>如此一来，便形成了通过地址栏进行导航的深度链接（deeplinking ），也就是我们所需要的路由机制。通过路由机制，一个单页应用的各个视图就可以很好的组织起来了。</p><p><br/></p><p>4.9.1 ngRoute内容</p><p><br/></p><p>　　ng的路由机制是靠ngRoute提供的，通过hash和history两种方式实现了路由，可以检测浏览器是否支持history来灵活调用相应的方式。ng的路由(ngRoute)是一个单独的模块，包含以下内容：</p><p><br/></p><p>l 服务$routeProvider用来定义一个路由表，即地址栏与视图模板的映射</p><p><br/></p><p>l 服务$routeParams保存了地址栏中的参数，例如{id : 1, name : &#39;tom&#39;}</p><p><br/></p><p>l 服务$route完成路由匹配，并且提供路由相关的属性访问及事件，如访问当前路由对应的controller</p><p><br/></p><p>l 指令ngView用来在主视图中指定加载子视图的区域</p><p><br/></p><p>　以上内容再加上$location服务，我们就可以实现一个单页面应用了。下面来看一下具体如何使用这些内容。</p><p><br/></p><p>4.9.2 ng的路由机制</p><p><br/></p><p>　　第一步：引入文件和依赖</p><p><br/></p><p>　　ngRoute模块包含在一个单独的文件中，所以第一步需要在页面上引入这个文件，如下：</p><p><br/></p><p>&lt;script src=&quot;http://code.angularjs.org/1.2.8/angular.min.js&quot; rel=&quot;nofollow&quot;/&gt;</p><p><br/></p><p>&lt;script src=&quot;http://code.angularjs.org/1.2.8/angular-route.min.js&quot; rel=&quot;nofollow&quot;/&gt;　　</p><p><br/></p><p>光引入还不够，我们还需在模块声明中注入对ngRoute的依赖，如下：</p><p><br/></p><p>var app = angular.module(&#39;MyApp&#39;, [&#39;ngRoute&#39;]);　　</p><p><br/></p><p>完成了这些，我们就可以在模板或是controller中使用上面的服务和指令了。下面我们需要定义一个路由表。</p><p><br/></p><p>　　第二步：定义路由表</p><p><br/></p><p>　　$routeProvider提供了定义路由表的服务，它有两个核心方法，when(path,route)和otherwise(params)，先看一下核心中的核心when(path,route)方法。</p><p><br/></p><p>　　when(path,route)方法接收两个参数，path是一个string类型，表示该条路由规则所匹配的路径，它将与地址栏的内容($location.path)值进行匹配。如果需要匹配参数，可以在path中使用冒号加名称的方式，如：path为/show/:name，如果地址栏是/show/tom，那么参数name和所对应的值tom便会被保存在$routeParams中，像这样：{name : tom}。我们也可以用*进行模糊匹配，如：/show*/:name将匹配/showInfo/tom。</p><p><br/></p><p>　　route参数是一个object，用来指定当path匹配后所需的一系列配置项，包括以下内容：</p><p><br/></p><p>l controller //function或string类型。在当前模板上执行的controller函数，生成新的scope；</p><p><br/></p><p>l controllerAs //string类型，为controller指定别名；</p><p><br/></p><p>l template //string或function类型，视图z所用的模板，这部分内容将被ngView引用；</p><p><br/></p><p>l templateUrl //string或function类型，当视图模板为单独的html文件或是使用了&lt;script type=&quot;text/ng-template&quot;&gt;定义模板时使用；</p><p><br/></p><p>l resolve //指定当前controller所依赖的其他模块；</p><p><br/></p><p>l redirectTo //重定向的地址。</p><p><br/></p><p>最简单情况，我们定义一个html文件为模板，并初始化一个指定的controller：</p><p><br/></p><p>function emailRouteConfig($routeProvider){</p><p><br/></p><p>&nbsp; &nbsp; $routeProvider.when(&#39;/show&#39;, {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; controller: ShowController,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; templateUrl: &#39;show.html&#39;</p><p><br/></p><p>&nbsp; &nbsp; }).</p><p><br/></p><p>&nbsp; &nbsp; when(&#39;/put/:name&#39;,{</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp;controller: PutController,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp;templateUrl: &#39;put.html&#39;</p><p><br/></p><p>&nbsp; &nbsp; }); &nbsp;</p><p><br/></p><p>};　　</p><p><br/></p><p>otherwise(params)方法对应路径匹配不到时的情况，这时候我们可以配置一个redirectTo参数，让它重定向到404页面或者是首页。</p><p><br/></p><p>　　第三步：在主视图模板中指定加载子视图的位置</p><p><br/></p><p>　　我们的单页面程序都是局部刷新的，那这个“局部”是哪里呢，这就轮到ngView出马了，只需在模板中简单的使用此指令，在哪里用，哪里就是“局部”。例如：</p><p><br/></p><p>&lt;div ng-view&gt;&lt;/div&gt;　　或：&lt;ng-view&gt;&lt;/ng-view&gt;　　</p><p><br/></p><p>我们的子视图将会在此处被引入进来。完成这三步后，你的程序的路由就配置好了。</p><p><br/></p><p>4.9.3 路由示例</p><p><br/></p><p>下面我们将用一个例子（例09）来说明路由的使用方式及步骤：</p><p><br/></p><p>1.为demoApp添加一个路由，代码如下：</p><p><br/></p><p>demoApp.config([&#39;$routeProvider&#39;,function($routeProvider) { &nbsp;</p><p><br/></p><p>$routeProvider.when(&#39;/list&#39;, { &nbsp;</p><p><br/></p><p>templateUrl: &#39;route/list.html&#39;, &nbsp;</p><p><br/></p><p>&nbsp; controller: &#39;routeListController&#39;</p><p><br/></p><p>}).when(&#39;/list/:id&#39;, { &nbsp;</p><p><br/></p><p>&nbsp; templateUrl: &#39;route/detail.html&#39;,</p><p><br/></p><p>&nbsp; &nbsp;controller: &#39;routeDetailController&#39;</p><p><br/></p><p>&nbsp; }).otherwise({ &nbsp;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; redirectTo: &#39;/list&#39; &nbsp;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp;}); &nbsp;</p><p><br/></p><p>}]);</p><p><br/></p><p>/list 对应为：route/list.html页面，显示用户列表；/list/:id对应于route/detail.html页面，显示用户详细信息。</p><p><br/></p><p>2.为list.html和detail.html分别声明Controller：routeListController和routeDetailController。</p><p><br/></p><p>demoApp.controller(&#39;routeListController&#39;,function($scope) { &nbsp;</p><p><br/></p><p>$scope.users = [{userId:&quot;zhangsan&quot;,userName:&quot;张三&quot;,userInfo:&quot;我是张三，我为自己带盐！&quot;},</p><p><br/></p><p>{userId:&quot;lisi&quot;,userName:&quot;李四&quot;,userInfo:&quot;我是李四，我为卿狂！&quot;},</p><p><br/></p><p>{userId:&quot;woshishui&quot;,userName:&quot;我是谁&quot;,userInfo:&quot;我是谁！我是谁！我是谁！&quot;}];</p><p><br/></p><p>&nbsp;</p><p><br/></p><p>}); &nbsp;</p><p><br/></p><p>demoApp.controller(&#39;routeDetailController&#39;,function($scope, $routeParams, userService) { &nbsp;</p><p><br/></p><p>&nbsp; &nbsp; $scope.userDetail = userService.getUser($routeParams.id);</p><p><br/></p><p>});</p><p><br/></p><p>routeDetailController中如上面提到的一样，注入了userService服务，在这里直接拿来用。</p><p><br/></p><p>3.创建list.html和detail.html页面，代码如下：</p><p><br/></p><p>&lt;hr/&gt; &nbsp;</p><p><br/></p><p>&lt;h3&gt;Route : List.html（用户列表页面）&lt;/h3&gt; &nbsp;</p><p><br/></p><p>&lt;ul&gt; &nbsp;</p><p><br/></p><p>&lt;li ng-repeat=&quot;user in users&quot;&gt; &nbsp;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &lt;a href=&quot;http://m.cnblogs.com/142260/3817063.html?full=1#/list/{{ user.userId }}&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;</p><p><br/></p><p>&lt;/li&gt; &nbsp;</p><p><br/></p><p>&lt;/ul&gt;</p><p><br/></p><p>&lt;hr/&gt;</p><p><br/></p><p>&nbsp;</p><p><br/></p><p>&lt;h3&gt;Route : detail.html（用户详细信息页面）&lt;/h3&gt; &nbsp;</p><p><br/></p><p>&lt;h3&gt;用户名：&lt;span style=&quot;color: red;&quot;&gt;{{userDetail.userName}}&lt;/span&gt;&lt;/h3&gt;</p><p><br/></p><p>&lt;div&gt;</p><p><br/></p><p>&lt;span&gt;用户ID：{{userDetail.userId}}&lt;/span&gt;&lt;span&gt;用户名：{{userDetail.userName}}&lt;/span&gt;</p><p><br/></p><p>&lt;/div&gt;</p><p><br/></p><p>&lt;div&gt;</p><p><br/></p><p>用户简介：&lt;span&gt;{{userDetail.userInfo}}&lt;/span&gt;</p><p><br/></p><p>&lt;/div&gt;</p><p><br/></p><p>&lt;div&gt;</p><p><br/></p><p>&lt;a href=&quot;http://m.cnblogs.com/142260/3817063.html?full=1#/list&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;返回&lt;/a&gt; &nbsp;</p><p><br/></p><p>&lt;/div&gt;</p><p><br/></p><p>4. 路由局部刷新位置：</p><p><br/></p><p>&lt;h1&gt;AngularJS路由（Route） 示例&lt;/h1&gt; &nbsp;</p><p><br/></p><p>&lt;div ng-view&gt;&lt;/div&gt;</p><p><br/></p><p>4.10 NG动画效果</p><p><br/></p><p>4.10.1 NG动画效果简介</p><p><br/></p><p>NG动画效果，现在可以通过CSS3或者是JS来实现，如果是通过JS来实现的话，需要其他JS库（比如JQuery）来支持，实际上底层实现还是靠其他JS库，只是NG将其封装了，</p><p><br/></p><p>使其更易使用。</p><p><br/></p><p>NG动画效果包含以下几种：</p><p><br/></p><p>enter：元素添加到DOM中时执行动画；leave：元素从DOM删除时执行动画；move：移动元素时执行动画；beforeAddClass：在给元素添加CLASS之前执行动画；addClass：在给元素添加CLASS时执行动画；beforeRemoveClass：在给元素删除CLASS之前执行动画；removeClass：在给元素删除CLASS时执行动画。</p><p>其相关参数为：</p><p><br/></p><p>var ngModule = angular.module(&#39;YourApp&#39;, [&#39;ngAnimate&#39;]);</p><p><br/></p><p>&nbsp; demoApp.animation(&#39;.my-crazy-animation&#39;, function() {</p><p><br/></p><p>return {</p><p><br/></p><p>&nbsp; &nbsp;enter: function(element, done) {</p><p><br/></p><p>&nbsp; //run the animation here and call done when the animation is complete</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; return function(cancelled) {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //this (optional) function will be called when the animation</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //completes or when the animation is cancelled (the cancelled</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //flag will be set to true if cancelled).</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; };</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; },</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; leave: function(element, done) { },</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; move: function(element, done) { },</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; //animation that can be triggered before the class is added</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; beforeAddClass: function(element, className, done) { },</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; //animation that can be triggered after the class is added</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; addClass: function(element, className, done) { },</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; //animation that can be triggered before the class is removed</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; beforeRemoveClass: function(element, className, done) { },</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; //animation that can be triggered after the class is removed</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; removeClass: function(element, className, done) { }</p><p><br/></p><p>&nbsp; &nbsp; };</p><p><br/></p><p>&nbsp; });</p><p><br/></p><p>4.10.2 动画效果示例</p><p><br/></p><p>下面我们来看下DEMO中的例子（例10）。</p><p><br/></p><p>1.首先，我们在demoApp下定义一个动画效果，匹配CLASS：” .border-animation”</p><p><br/></p><p>/*定义动画*/</p><p><br/></p><p>demoApp.animation(&#39;.border-animation&#39;, function(){&nbsp;</p><p><br/></p><p>return{&nbsp;</p><p><br/></p><p>beforeAddClass : function (element, className, done) {&nbsp;</p><p><br/></p><p>$(element).stop().animate({</p><p><br/></p><p>&#39;border-width&#39;:1</p><p><br/></p><p>},2000, function() {</p><p><br/></p><p>done();&nbsp;</p><p><br/></p><p>});</p><p><br/></p><p>},&nbsp;</p><p><br/></p><p>removeClass : function (element ,className ,done ) {&nbsp;</p><p><br/></p><p>$(element).stop().animate({</p><p><br/></p><p>&#39;border-width&#39;:50</p><p><br/></p><p>},3000, function() {</p><p><br/></p><p>done();&nbsp;</p><p><br/></p><p>});</p><p><br/></p><p>}&nbsp;</p><p><br/></p><p>};&nbsp;</p><p><br/></p><p>});</p><p><br/></p><p>动画效果的含义就是：在匹配CLASS为border-animation的元素添加一个CLASS之前使其边框的宽度在2秒内变为1PX；并在其移除一个CLASS时使其边框的宽度在3秒内变为50PX。</p><p><br/></p><p>2. 视图中的代码如下（主要，其他相关样式请查看例子代码）：</p><p><br/></p><p>&lt;div class=&quot;border-animation&quot; ng-show=&quot;testShow&quot;&gt;&lt;/div&gt;</p><p><br/></p><p>&lt;a href=&quot;javascript:void(0);&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;</p><p><br/></p><p>ng-show为false时会为其加上“ng-hide“的CLASS; ng-show为true时会为其移除“ng-hide“的CLASS，从而触发动画效果。</p><p><br/></p><p>3.其他代码：</p><p><br/></p><p>demoApp.controller(&quot;test10Controller&quot;, function($scope, $animate){</p><p><br/></p><p>$scope.testShow = true;</p><p><br/></p><p>});</p><p><br/></p><p>5 功能演示</p><p>略（详情请看AngularJS/demo WEB演示）</p><p><br/></p><p>6 AngularJS进阶</p><p>6.1数据绑定原理研究</p><p><br/></p><p>Angular用户都想知道数据绑定是怎么实现的。你可能会看到各种各样的词汇：$watch、$apply、$digest、dirty-checking...它们是什么？它们是如何工作的呢？这里我想回答这些问题，其实它们在官方的文档里都已经回答了，但是我还是想把它们结合在一起来讲，但是我只是用一种简单的方法来讲解，如果要想了解技术细节，查看源代码。</p><p><br/></p><p>6.1.1 AngularJS扩展事件循环</p><p><br/></p><p>我们的浏览器一直在等待事件，比如用户交互。假如你点击一个按钮或者在输入框里输入东西，事件的回调函数就会在javascript解释器里执行，然后你就可以做任何DOM操作，等回调函数执行完毕时，浏览器就会相应地对DOM做出变化。（记住，这是个重要的概念），为了解释什么是context以及它如何工作，我们还需要解释更多的概念。</p><p><br/></p><p>6.1.2 $watch 队列</p><p><br/></p><p>每次你绑定一些东西到你的DOM上时你就会往$watch队列里插入一条$watch。想象一下$watch就是那个可以检测它监视的model里时候有变化的东西。例如你有如下的代码：</p><p><br/></p><p>/*View &nbsp;index.html */</p><p><br/></p><p>User: &lt;input type=&quot;text&quot; ng-model=&quot;user&quot; /&gt;</p><p><br/></p><p>Password: &lt;input type=&quot;password&quot; ng-model=&quot;pass&quot; /&gt;</p><p><br/></p><p>在这里我们有个$scope.user，他被绑定在了第一个输入框上，还有个$scope.pass，它被绑定在了第二个输入框上，然后我们在$watch list里面加入两个$watch。</p><p><br/></p><p>再看下面的例子：</p><p><br/></p><p>/*Controller &nbsp;controllers.js */</p><p><br/></p><p>app.controller(&#39;MainCtrl&#39;, function($scope) {</p><p><br/></p><p>&nbsp; &nbsp;$scope.foo = &quot;Foo&quot;;</p><p><br/></p><p>&nbsp; &nbsp;$scope.world = &quot;World&quot;;</p><p><br/></p><p>});</p><p><br/></p><p>/*View &nbsp;index.html */</p><p><br/></p><p>Hello, {{ World }}</p><p><br/></p><p>这里，即便我们在$scope上添加了两个东西，但是只有一个绑定在了DOM上，因此在这里只生成了一个$watch。</p><p><br/></p><p>再看下面的例子：</p><p><br/></p><p>/*Controller &nbsp;controllers.js */</p><p><br/></p><p>app.controller(&#39;MainCtrl&#39;, function($scope) {</p><p><br/></p><p>&nbsp; $scope.people = [...];</p><p><br/></p><p>});</p><p><br/></p><p>/*View &nbsp;index.html */</p><p><br/></p><p>&lt;ul&gt;</p><p><br/></p><p>&nbsp; &lt;li ng-repeat=&quot;person in people&quot;&gt;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; {{person.name}} - {{person.age}}</p><p><br/></p><p>&nbsp; &lt;/li&gt;</p><p><br/></p><p>&lt;/ul&gt;</p><p><br/></p><p>这里又生成了多少个$watch呢？每个person有两个（一个name，一个age），然后ng-repeat又有一个，因此10个person一共是(2 * 10) +1,也就是说有21个$watch。&nbsp;</p><p><br/></p><p>因此，每一个绑定到了DOM上的数据都会生成一个$watch。</p><p><br/></p><p>那这写$watch是什么时候生成的呢？&nbsp;</p><p><br/></p><p>当我们的模版加载完毕时，也就是在linking阶段（Angular分为compile阶段和linking阶段），Angular解释器会寻找每个directive，然后生成每个需要的$watch。</p><p><br/></p><p>6.1.3 $digest循环</p><p><br/></p><p>还记得我前面提到的扩展的事件循环吗？当浏览器接收到可以被angular context处理的事件时，$digest循环就会触发。这个循环是由两个更小的循环组合起来的。一个处理evalAsync队列，另一个处理$watch队列。 这个是处理什么的呢？$digest将会遍历我们的$watch，然后询问：</p><p><br/></p><p>•嘿，$watch，你的值是什么？&nbsp;</p><p><br/></p><p>◦是9。</p><p><br/></p><p>•好的，它改变过吗？&nbsp;</p><p><br/></p><p>◦没有，先生。</p><p><br/></p><p>•（这个变量没变过，那下一个）</p><p><br/></p><p>•你呢，你的值是多少？&nbsp;</p><p><br/></p><p>◦报告，是Foo。</p><p><br/></p><p>•刚才改变过没？&nbsp;</p><p><br/></p><p>◦改变过，刚才是Bar。</p><p><br/></p><p>•（很好，我们有DOM需要更新了）</p><p><br/></p><p>•继续询问直到$watch队列都检查过。</p><p><br/></p><p>这就是所谓的dirty-checking。既然所有的$watch都检查完了，那就要问了：有没有$watch更新过？如果有至少一个更新过，这个循环就会再次触发，直到所有的$watch都没有变化。这样就能够保证每个model都已经不会再变化。记住如果循环超过10次的话，它将会抛出一个异常，防止无限循环。当$digest循环结束时，DOM相应地变化。</p><p><br/></p><p>例如：&nbsp;</p><p><br/></p><p>/*Controller &nbsp;controllers.js */</p><p><br/></p><p>app.controller(&#39;MainCtrl&#39;, function() {</p><p><br/></p><p>&nbsp; $scope.name = &quot;Foo&quot;;</p><p><br/></p><p>&nbsp; $scope.changeFoo = function() {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; $scope.name = &quot;Bar&quot;;</p><p><br/></p><p>&nbsp; }</p><p><br/></p><p>});</p><p><br/></p><p>/*View &nbsp;index.html */</p><p><br/></p><p>{{ name }}</p><p><br/></p><p>&lt;button ng-click=&quot;changeFoo()&quot;&gt;Change the name&lt;/button&gt;</p><p><br/></p><p>这里我们有一个$watch因为ng-click不生成$watch（函数是不会变的）。</p><p><br/></p><p>我们可以看出ng的处理流程：</p><p><br/></p><p>•我们按下按钮；</p><p><br/></p><p>•浏览器接收到一个事件，进入angular context；</p><p><br/></p><p>•$digest循环开始执行，查询每个$watch是否变化；</p><p><br/></p><p>•由于监视$scope.name的$watch报告了变化，它会强制再执行一次$digest循环；</p><p><br/></p><p>•新的$digest循环没有检测到变化；</p><p><br/></p><p>•浏览器拿回控制权，更新与$scope.name新值相应部分的DOM。</p><p><br/></p><p>这里很重要的是每一个进入angular context的事件都会执行一个$digest循环，也就是说每次我们输入一个字母循环都会检查整个页面的所有$watch。</p><p><br/></p><p>6.1.4如何进入angular context</p><p><br/></p><p>谁决定什么事件进入angular context，而哪些又不进入呢？通过$apply！</p><p><br/></p><p>如果当事件触发时，你调用$apply，它会进入angular context，如果没有调用就不会进入。现在你可能会问：刚才的例子里我也没有调用$apply啊，为什么？Angular已经做了！因此你点击带有ng-click的元素时，时间就会被封装到一个$apply调用。如果你有一个ng-model=&quot;foo&quot;的输入框，然后你敲一个f，事件就会这样调用$apply(&quot;foo = &#39;f&#39;;&quot;)。</p><p><br/></p><p>Angular什么时候不会自动为我们$apply呢？</p><p><br/></p><p>这是Angular新手共同的痛处。为什么我的jQuery不会更新我绑定的东西呢？因为jQuery没有调用$apply，事件没有进入angular context，$digest循环永远没有执行。</p><p><br/></p><p>我们来看一个有趣的例子：</p><p><br/></p><p>假设我们有下面这个directive和controller。</p><p><br/></p><p>/*Controller &nbsp;app.js */</p><p><br/></p><p>app.directive(&#39;clickable&#39;, function() {</p><p><br/></p><p>return {</p><p><br/></p><p>&nbsp; restrict: &quot;E&quot;,</p><p><br/></p><p>&nbsp; scope: {</p><p><br/></p><p>&nbsp; &nbsp; foo: &#39;=&#39;,</p><p><br/></p><p>&nbsp; &nbsp; bar: &#39;=&#39;</p><p><br/></p><p>&nbsp; },</p><p><br/></p><p>&nbsp; template: &#39;&lt;ul style=&quot;&lt;li&gt;{{foo}}&lt;/li&gt;&lt;li&gt;{{bar}}&lt;/li&gt;&lt;/ul&gt;&#39;,</p><p><br/></p><p>&nbsp; link: function(scope, element, attrs) {</p><p><br/></p><p>&nbsp; &nbsp; element.bind(&#39;click&#39;, function() {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; scope.foo++;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; scope.bar++;</p><p><br/></p><p>&nbsp; &nbsp; });</p><p><br/></p><p>&nbsp; }</p><p><br/></p><p>}</p><p><br/></p><p>});</p><p><br/></p><p>app.controller(&#39;MainCtrl&#39;, function($scope) {</p><p><br/></p><p>&nbsp; $scope.foo = 0;</p><p><br/></p><p>&nbsp; $scope.bar = 0;</p><p><br/></p><p>});</p><p><br/></p><p>它将foo和bar从controller里绑定到一个list里面，每次点击这个元素的时候，foo和bar都会自增1。那我们点击元素的时候会发生什么呢？我们能看到更新吗？答案是否定的。因为点击事件是一个没有封装到$apply里面的常见的事件，这意味着我们会失去我们的计数吗？不会。</p><p><br/></p><p>真正的结果是：$scope确实改变了，但是没有强制$digest循环，监视foo 和bar的$watch没有执行。也就是说如果我们自己执行一次$apply那么这些$watch就会看见这些变化，然后根据需要更新DOM。</p><p><br/></p><p>执行$apply：</p><p><br/></p><p>element.bind(&#39;click&#39;, function() {</p><p><br/></p><p>scope.foo++;</p><p><br/></p><p>&nbsp; scope.bar++;</p><p><br/></p><p>&nbsp; scope.$apply();</p><p><br/></p><p>});</p><p><br/></p><p>$apply是我们的$scope（或者是direcvie里的link函数中的scope）的一个函数，调用它会强制一次$digest循环（除非当前正在执行循环，这种情况下会抛出一个异常，这是我们不需要在那里执行$apply的标志）。</p><p><br/></p><p>更好的使用$apply的方法：</p><p><br/></p><p>element.bind(&#39;click&#39;, function() {</p><p><br/></p><p>&nbsp; scope.$apply(function() {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; scope.foo++;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; scope.bar++;</p><p><br/></p><p>&nbsp; });</p><p><br/></p><p>})</p><p><br/></p><p>有什么不一样的？差别就是在第一个版本中，我们是在angular context的外面更新的数据，如果有发生错误，Angular永远不知道。很明显在这个像个小玩具的例子里面不会出什么大错，但是想象一下我们如果有个alert框显示错误给用户，然后我们有个第三方的库进行一个网络调用然后失败了，如果我们不把它封装进$apply里面，Angular永远不会知道失败了，alert框就永远不会弹出来了。</p><p><br/></p><p>因此，如果你想使用一个jQuery插件，并且要执行$digest循环来更新你的DOM的话，要确保你调用了$apply。</p><p><br/></p><p>有时候我想多说一句的是有些人在不得不调用$apply时会“感觉不妙”，因为他们会觉得他们做错了什么。其实不是这样的，Angular不是什么魔术师，他也不知道第三方库想要更新绑定的数据。</p><p><br/></p><p>6.1.5使用$watch来监视</p><p><br/></p><p>你已经知道了我们设置的任何绑定都有一个它自己的$watch，当需要时更新DOM，但是我们如果要自定义自己的watches呢？简单，来看个例子：</p><p><br/></p><p>/*Controller &nbsp;app.js */</p><p><br/></p><p>app.controller(&#39;MainCtrl&#39;, function($scope) {</p><p><br/></p><p>&nbsp; $scope.name = &quot;Angular&quot;;</p><p><br/></p><p>&nbsp; $scope.updated = -1;</p><p><br/></p><p>&nbsp; $scope.$watch(&#39;name&#39;, function() {</p><p><br/></p><p>&nbsp; &nbsp; $scope.updated++;</p><p><br/></p><p>&nbsp; });</p><p><br/></p><p>});</p><p><br/></p><p>/*View &nbsp;index.html*/</p><p><br/></p><p>&lt;body ng-controller=&quot;MainCtrl&quot;&gt;</p><p><br/></p><p>&nbsp; &lt;input ng-model=&quot;name&quot; /&gt;</p><p><br/></p><p>&nbsp; Name updated: {{updated}} times.</p><p><br/></p><p>&lt;/body&gt;</p><p><br/></p><p>这就是我们创造一个新的$watch的方法。第一个参数是一个字符串或者函数，在这里是只是一个字符串，就是我们要监视的变量的名字，在这里，$scope.name(注意我们只需要</p><p><br/></p><p>用name)。第二个参数是当$watch说我监视的表达式发生变化后要执行的。我们要知道的第一件事就是当controller执行到这个$watch时，它会立即执行一次，因此我们设置updated为-1。</p><p><br/></p><p>例子2：</p><p><br/></p><p>/*Controller &nbsp;app.js */</p><p><br/></p><p>app.controller(&#39;MainCtrl&#39;, function($scope) {</p><p><br/></p><p>&nbsp; $scope.name = &quot;Angular&quot;;</p><p><br/></p><p>&nbsp; $scope.updated = 0;</p><p><br/></p><p>&nbsp; $scope.$watch(&#39;name&#39;, function(newValue, oldValue) {</p><p><br/></p><p>&nbsp; &nbsp; if (newValue === oldValue) { return; } // AKA first run</p><p><br/></p><p>&nbsp; &nbsp; $scope.updated++;</p><p><br/></p><p>&nbsp; });</p><p><br/></p><p>});</p><p><br/></p><p>/*View &nbsp;index.html*/</p><p><br/></p><p>&lt;body ng-controller=&quot;MainCtrl&quot;&gt;</p><p><br/></p><p>&nbsp; &lt;input ng-model=&quot;name&quot; /&gt;</p><p><br/></p><p>&nbsp; Name updated: {{updated}} times.</p><p><br/></p><p>&lt;/body&gt;</p><p><br/></p><p>watch的第二个参数接受两个参数，新值和旧值。我们可以用他们来略过第一次的执行。通常你不需要略过第一次执行，但在这个例子里面你是需要的。</p><p><br/></p><p>例子3：</p><p><br/></p><p>/*Controller &nbsp;app.js */</p><p><br/></p><p>app.controller(&#39;MainCtrl&#39;, function($scope) {</p><p><br/></p><p>&nbsp; $scope.user = { name: &quot;Fox&quot; };</p><p><br/></p><p>&nbsp; $scope.updated = 0;</p><p><br/></p><p>&nbsp; $scope.$watch(&#39;user&#39;, function(newValue, oldValue) {</p><p><br/></p><p>&nbsp; &nbsp; if (newValue === oldValue) { return; }</p><p><br/></p><p>&nbsp; &nbsp; $scope.updated++;</p><p><br/></p><p>&nbsp; });</p><p><br/></p><p>});</p><p><br/></p><p>/*View &nbsp;index.html*/</p><p><br/></p><p>&lt;body ng-controller=&quot;MainCtrl&quot;&gt;</p><p><br/></p><p>&nbsp; &lt;input ng-model=&quot;user.name&quot; /&gt;</p><p><br/></p><p>&nbsp; Name updated: {{updated}} times.</p><p><br/></p><p>&lt;/body&gt;</p><p><br/></p><p>我们想要监视$scope.user对象里的任何变化，和以前一样这里只是用一个对象来代替前面的字符串。</p><p><br/></p><p>呃？没用，为啥？因为$watch默认是比较两个对象所引用的是否相同，在例子1和2里面，每次更改$scope.name都会创建一个新的基本变量，因此$watch会执行，因为对这个变量的引用已经改变了。在上面的例子里，我们在监视$scope.user，当我们改变$scope.user.name时，对$scope.user的引用是不会改变的，我们只是每次创建了一个新的$scope.user.name，但是$scope.user永远是一样的。</p><p><br/></p><p>例子4：</p><p><br/></p><p>/*Controller &nbsp;app.js */</p><p><br/></p><p>app.controller(&#39;MainCtrl&#39;, function($scope) {</p><p><br/></p><p>&nbsp; $scope.user = { name: &quot;Fox&quot; };</p><p><br/></p><p>&nbsp;</p><p><br/></p><p>&nbsp; $scope.updated = 0;</p><p><br/></p><p>&nbsp;</p><p><br/></p><p>&nbsp; $scope.$watch(&#39;user&#39;, function(newValue, oldValue) {</p><p><br/></p><p>&nbsp; &nbsp; if (newValue === oldValue) { return; }</p><p><br/></p><p>&nbsp; &nbsp; $scope.updated++;</p><p><br/></p><p>&nbsp; }, true &nbsp;);</p><p><br/></p><p>});</p><p><br/></p><p>/*View &nbsp;index.html*/</p><p><br/></p><p>&lt;body ng-controller=&quot;MainCtrl&quot;&gt;</p><p><br/></p><p>&nbsp; &lt;input ng-model=&quot;user.name&quot; /&gt;</p><p><br/></p><p>&nbsp; Name updated: {{updated}} times.</p><p><br/></p><p>&lt;/body&gt;</p><p><br/></p><p>现在有用了吧！因为我们对$watch加入了第三个参数，它是一个bool类型的参数，表示的是我们比较的是对象的值而不是引用。由于当我们更新$scope.user.name时$scope.user也会改变，所以能够正确触发。</p><p><br/></p><p>6.1.6 总结</p><p><br/></p><p>我希望你们已经学会了在Angular中数据绑定是如何工作的。我猜想你的第一印象是dirty-checking很慢，好吧，其实是不对的。它像闪电般快。但是，如果你在一个模版里有2000-3000个watch，它会开始变慢。但是我觉得如果你达到这个数量级，就可以找个用户体验专家咨询一下了。</p><p><br/></p><p>无论如何，随着ECMAScript6的到来，在Angular未来的版本里我们将会有Object.observe那样会极大改善$digest循环的速度。</p><p><br/></p><p>6.2自定义指令详解</p><p><br/></p><p>angular的指令机制。angular通过指令的方式实现了HTML的扩展，增强后的HTML不仅长相焕然一新，同时也获得了很多强大的技能。更厉害的是，你还可以自定义指令，这就意味着HTML标签的范围可以扩展到无穷大。angular赋予了你造物主的能力。既然是作为angular的精华之一，相应的指令相关的知识也很多的。</p><p><br/></p><p>6.2.1指令的编译过程</p><p><br/></p><p>　　在开始自定义指令之前，我们有必要了解一下指令在框架中的执行流程：</p><p><br/></p><p>1.浏览器得到 HTML 字符串内容，解析得到 DOM 结构。</p><p><br/></p><p>2.ng 引入，把 DOM 结构扔给 $compile 函数处理：</p><p><br/></p><p>① 找出 DOM 结构中有变量占位符；</p><p><br/></p><p>② 匹配找出 DOM 中包含的所有指令引用；</p><p><br/></p><p>③ 把指令关联到 DOM；</p><p><br/></p><p>④ 关联到 DOM 的多个指令按权重排列；</p><p><br/></p><p>⑤ 执行指令中的 compile 函数（改变 DOM 结构，返回 link 函数）；</p><p><br/></p><p>⑥ 得到的所有 link 函数组成一个列表作为 $compile 函数的返回。</p><p><br/></p><p>3. 执行 link 函数（连接模板的 scope）。</p><p><br/></p><p>这里注意区别一下$compile和compile，前者是ng内部的编译服务，后者是指令中的编译函数，两者发挥作用的范围不同。compile和link函数息息相关又有所区别，这个在后面会讲。了解执行流程对后面的理解会有帮助。</p><p><br/></p><p>在这里有些人可能会问，angular不就是一个js框架吗，怎么还能跟编译扯上呢，又不是像C++那样的高级语言。其实此编译非彼编译，ng编译的工作是解析指令、绑定监听器、替换模板中的变量等。因为工作方式很像高级语言编辑中的递归、堆栈过程，所以起名为编译，不要疑惑。</p><p><br/></p><p>6.2.2指令的使用方式及命名方法</p><p><br/></p><p>　　指令的几种使用方式如下：</p><p><br/></p><p>作为标签：&lt;my-dir&gt;&lt;/my-dir&gt;作为属性：&lt;span my-dir=&quot;exp&quot;&gt;&lt;/span&gt;作为注释：&lt;!-- directive: my-dir exp --&gt;作为类名：&lt;span class=&quot;my-dir: exp;&quot;&gt;&lt;/span&gt;</p><p>　　其实常用的就是作为标签和属性，下面两种用法目前还没见过，感觉就是用来卖萌的，姑且留个印象。我们自定义的指令就是要支持这样的用法。</p><p><br/></p><p>关于自定义指令的命名，你可以随便怎么起名字都行，官方是推荐用[命名空间-指令名称]这样的方式，像ng-controller。不过你可千万不要用ng-前缀了，防止与系统自带的指令重名。另外一个需知道的地方，指令命名时用驼峰规则，使用时用-分割各单词。如：定义myDirective，使用时像这样：&lt;my-directive&gt;。</p><p><br/></p><p>6.2.3自定义指令的配置参数</p><p><br/></p><p>下面是定义一个标准指令的示例，可配置的参数包括以下部分：</p><p><br/></p><p>myModule.directive(&#39;namespaceDirectiveName&#39;, function factory(injectables) {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; var directiveDefinitionObject = {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; restrict: string,//指令的使用方式，包括标签，属性，类，注释</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; priority: number,//指令执行的优先级</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; template: string,//指令使用的模板，用HTML字符串的形式表示</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; templateUrl: string,//从指定的url地址加载模板</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; replace: bool,//是否用模板替换当前元素，若为false，则append在当前元素上</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; transclude: bool,//是否将当前元素的内容转移到模板中</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scope: bool or object,//指定指令的作用域</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; controller: function controllerConstructor($scope, $element, $attrs, $transclude){...},//定义与其他指令进行交互的接口函数</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; require: string,//指定需要依赖的其他指令</p><p><br/></p><p>link: function postLink(scope, iElement, iAttrs) {...},//以编程的方式操作DOM，包</p><p><br/></p><p>括添加监听器等</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; compile: function compile(tElement, tAttrs, transclude){</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return: {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pre: function preLink(scope, iElement, iAttrs, controller){...},</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; post: function postLink(scope, iElement, iAttrs, controller){...}</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }//编程的方式修改DOM模板的副本，可以返回链接函数</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; };</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; return directiveDefinitionObject;</p><p><br/></p><p>}); &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><br/></p><p>看上去好复杂的样子，定义一个指令需要这么多步骤嘛？当然不是，你可以根据自己的需要来选择使用哪些参数。事实上priority和compile用的比较少，template和templateUrl又是互斥的，两者选其一即可。所以不必紧张，接下来分别学习一下这些参数：</p><p><br/></p><p>l 指令的表现配置参数：restrict、template、templateUrl、replace、transclude；</p><p><br/></p><p>l 指令的行为配置参数：compile和link；</p><p><br/></p><p>l 指令划分作用域配置参数：scope；</p><p><br/></p><p>l 指令间通信配置参数：controller和require。</p><p><br/></p><p>6.2.3指令的表现参数restrict等</p><p><br/></p><p>指令的表现配置参数：restrict、template、templateUrl、replace、transclude。</p><p><br/></p><p>我将先从一个简单的例子开始。</p><p><br/></p><p>&nbsp; &nbsp; 例子的代码如下：</p><p><br/></p><p>var app = angular.module(&#39;MyApp&#39;, [], function(){console.log(&#39;here&#39;)});</p><p><br/></p><p>app.directive(&#39;sayHello&#39;,function(){</p><p><br/></p><p>return {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp;restrict : &#39;E&#39;,</p><p><br/></p><p>template : &#39;&lt;div&gt;hello&lt;/div&gt;&#39;</p><p><br/></p><p>};</p><p><br/></p><p>}) &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><br/></p><p>然后在页面中，我们就可以使用这个名为sayHello的指令了，它的作用就是输出一个hello单词。像这样使用：</p><p><br/></p><p>&lt;say-hello&gt;&lt;/say-hello&gt; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><br/></p><p>这样页面就会显示出hello了，看一下生成的代码：</p><p><br/></p><p>&lt;say-hello&gt;</p><p><br/></p><p>&lt;div&gt;hello&lt;/div&gt;</p><p><br/></p><p>&lt;/say-hello&gt;&nbsp;</p><p><br/></p><p>&nbsp;　　稍稍解释一下我们用到的两个参数，restirct用来指定指令的使用类型，其取值及含义如下：</p><p><br/></p><p>取值</p><p><br/></p><p>含义</p><p><br/></p><p>使用示例</p><p><br/></p><p>E</p><p><br/></p><p>标签</p><p><br/></p><p>&lt;my-menu title=Products&gt;&lt;/my-menu&gt;</p><p><br/></p><p>A</p><p><br/></p><p>属性</p><p><br/></p><p>&lt;div my-menu=Products&gt;&lt;/div&gt;</p><p><br/></p><p>C</p><p><br/></p><p>类</p><p><br/></p><p>&lt;div class=&quot;my-menu&quot;:Products&gt;&lt;/div&gt;</p><p><br/></p><p>M</p><p><br/></p><p>注释</p><p><br/></p><p>&lt;!--directive:my-menu Products--&gt;</p><p><br/></p><p>默认值是A。也可以使用这些值的组合，如EA，EC等等。我们这里指定为E，那么它就可以像标签一样使用了。如果指定为A，我们使用起来应该像这样：</p><p><br/></p><p>&lt;div say-hello&gt;&lt;/div&gt;</p><p><br/></p><p>从生成的代码中，你也看到了template的作用，它就是描述你的指令长什么样子，这部分内容将出现在页面中，即该指令所在的模板中，既然是模板中，template的内容中也可以使用ng-modle等其他指令，就像在模板中使用一样。</p><p><br/></p><p>在上面生成的代码中，我们看到了&lt;div&gt;hello&lt;/div&gt;外面还包着一层&lt;say-hello&gt;标签，如果我们不想要这一层多余的东西了，replace就派上用场了，在配置中将replace赋值为true，将得到如下结构：</p><p><br/></p><p>&lt;div&gt;hello&lt;/div&gt;</p><p><br/></p><p>&nbsp;　　replace的作用正如其名，将指令标签替换为了temple中定义的内容。不写的话默认为false。</p><p><br/></p><p>上面的template未免也太简单了，如果你的模板HTML较复杂，如自定义一个ui组件指令，难道要拼接老长的字符串？当然不需要，此时只需用templateUrl便可解决问题。你可以将指令的模板单独命名为一个html文件，然后在指令定义中使用templateUrl指定好文件的路径即可，如：</p><p><br/></p><p>templateUrl : ‘helloTemplate.html’ &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><br/></p><p>系统会自动发一个http请求来获取到对应的模板内容。是不是很方便呢，你不用纠结于拼接字符串的烦恼了。如果你是一个追求完美的有考虑性能的工程师，可能会发问：那这样的话岂不是要牺牲一个http请求？这也不用担心，因为ng的模板还可以用另外一种方式定义，那就是使用&lt;script&gt;标签。使用起来如下：</p><p><br/></p><p>&lt;script type=&quot;text/ng-template&quot; id=&quot;helloTemplate.html&quot;&gt;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp;&lt;div&gt;hello&lt;/div&gt;</p><p><br/></p><p>&lt;/script&gt; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><br/></p><p>&nbsp;你可以把这段代码写在页面头部，这样就不必去请求它了。在实际项目中，你也可以将所有的模板内容集中在一个文件中，只加载一次，然后根据id来取用。</p><p><br/></p><p>接下来我们来看另一个比较有用的配置：transclude，定义是否将当前元素的内容转移到模板中。看解释有点抽象，不过亲手试试就很清楚了，看下面的代码（例06）：</p><p><br/></p><p>app.directive(&#39;sayHello&#39;,function(){</p><p><br/></p><p>return {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp;restrict : &#39;E&#39;,</p><p><br/></p><p>template : &#39;&lt;div&gt;hello，&lt;b ng-transclude&gt;&lt;/b&gt;！&lt;/div&gt;&#39;,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp;replace : true,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; transclude : true</p><p><br/></p><p>};</p><p><br/></p><p>}) &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><br/></p><p>指定了transclude为true，并且template修改了一下，加了一个&lt;b&gt;标签，并在上面使用了ng-transclude指令，用来告诉指令把内容转移到的位置。那我们要转移的内容是什么呢？请看使用指令时的变化：</p><p><br/></p><p>&lt;say-hello&gt;美女&lt;/say-hello&gt;</p><p><br/></p><p>内容是什么你也看到了哈~在运行的时候，美女将会被转移到&lt;b&gt;标签中，原来此配置的作用就是——乾坤大挪移！看效果：</p><p><br/></p><p>hello, 美女！</p><p><br/></p><p>这个还是很有用的，因为你定义的指令不可能老是那么简单，只有一个空标签。当你需要对指令中的内容进行处理时，此参数便大有可用。</p><p><br/></p><p>6.2.4指令的行为参数：compile和link</p><p><br/></p><p>6.2.3中简单介绍了自定义一个指令的几个简单参数，restrict、template、templateUrl、replace、transclude，这几个理解起来相对容易很多，因为它们只涉及到了表现，而没有涉及行为。我们继续学习ng自定义指令的几个重量级参数：compile和link</p><p><br/></p><p>l 理解compile和link</p><p><br/></p><p>　　不知大家有没有这样的感觉，自己定义指令的时候跟写jQuery插件有几分相似之处，都是先预先定义好页面结构及监听函数，然后在某个元素上调用一下，该元素便拥有了特殊的功能。区别在于，jQuery的侧重点是DOM操作，而ng的指令中除了可以进行DOM操作外，更注重的是数据和模板的绑定。jQuery插件在调用的时候才开始初始化，而ng指令在页面加载进来的时候就被编译服务($compile)初始化好了。</p><p><br/></p><p>在指令定义对象中，有compile和link两个参数，它们是做什么的呢？从字面意义上看，编译、链接，貌似太抽象了点。其实可大有内涵，为了在自定义指令的时候能正确使用它们，现在有必要了解一下ng是如何编译指令的。</p><p><br/></p><p>l 指令的解析流程详解</p><p><br/></p><p>　　我们知道ng框架会在页面载入完毕的时候，根据ng-app划定的作用域来调用$compile服务进行编译，这个$compile就像一个大总管一样，清点作用域内的DOM元素，看看哪些元素上使用了指令(如&lt;div ng-modle=”m”&gt;&lt;/div&gt;)，或者哪些元素本身就是个指令(如&lt;mydierc&gt;&lt;/mydirec&gt;)，或者使用了插值指令( {{}}也是一种指令，叫interpolation directive)，$compile大总管会把清点好的财产做一个清单，然后根据这些指令的优先级(priority)排列一下，真是个细心的大总管哈~大总管还会根据指令中的配置参数(template，place，transclude等)转换DOM，让指令“初具人形”。</p><p><br/></p><p>然后就开始按顺序执行各指令的compile函数，注意此处的compile可不是大总管$compile，人家带着$是土豪，此处执行的compile函数是我们指令中配置的，compile函数中可以访问到DOM节点并进行操作，其主要职责就是进行DOM转换，每个compile函数执行完后都会返回一个link函数，这些link函数会被大总管汇合一下组合成一个合体后的link函数，为了好理解，我们可以把它想象成葫芦小金刚，就像是进行了这样的处理。</p><p><br/></p><p>//合体后的link函数</p><p><br/></p><p>function AB(){</p><p><br/></p><p>&nbsp; A(); //子link函数</p><p><br/></p><p>&nbsp; B(); //子link函数</p><p><br/></p><p>}　　</p><p><br/></p><p>接下来进入link阶段，合体后的link函数被执行。所谓的链接，就是把view和scope链接起来。链接成啥样呢？就是我们熟悉的数据绑定，通过在DOM上注册监听器来动态修改scope中的数据，或者是使用$watchs监听 scope中的变量来修改DOM，从而建立双向绑定。由此也可以断定，葫芦小金刚可以访问到scope和DOM节点。</p><p><br/></p><p>不要忘了我们在定义指令中还配置着一个link参数呢，这么多link千万别搞混了。那这</p><p><br/></p><p>个link函数是干嘛的呢，我们不是有葫芦小金刚了嘛？那我告诉你，其实它是一个小三。此话怎讲？compile函数执行后返回link函数，但若没有配置compile函数呢？葫芦小金刚自然就不存在了。&nbsp;</p><p><br/></p><p>正房不在了，当然就轮到小三出马了，大总管$compile就把这里的link函数拿来执行。这就意味着，配置的link函数也可以访问到scope以及DOM节点。值得注意的是，compile函数通常是不会被配置的，因为我们定义一个指令的时候，大部分情况不会通过编程的方式进行DOM操作，而更多的是进行监听器的注册、数据的绑定。所以，小三名正言顺的被大总管宠爱。</p><p><br/></p><p>听完了大总管、葫芦小金刚和小三的故事，你是不是对指令的解析过程比较清晰了呢？不过细细推敲，你可能还是会觉得情节生硬，有些细节似乎还是没有透彻的明白，所以还需要再理解下面的知识点：</p><p><br/></p><p>l compile和link的区别</p><p><br/></p><p>　　其实在我看完官方文档后就一直有疑问，为什么监听器、数据绑定不能放在compile函数中，而偏偏要放在link函数中？为什么有了compile还需要link？就跟你质疑我编的故事一样，为什么最后小三被宠爱了？所以我们有必要探究一下，compile和link之间到底有什么区别。好，正房与小三的PK现在开始。</p><p><br/></p><p>首先是性能。举个例子：</p><p><br/></p><p>&lt;ul&gt;</p><p><br/></p><p>&nbsp; &lt;li ng-repeat=&quot;a in array&quot;&gt;</p><p><br/></p><p>&nbsp; &nbsp; &lt;input ng-modle=”a.m” /&gt;</p><p><br/></p><p>&nbsp; &lt;/li&gt;</p><p><br/></p><p>&lt;/ul&gt; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><br/></p><p>我们的观察目标是ng-repeat指令。假设一个前提是不存在link。大总管$compile在编译这段代码时，会查找到ng-repeat，然后执行它的compile函数，compile函数根据array的长度复制出n个&lt;li&gt;标签。而复制出的&lt;li&gt;节点中还有&lt;input&gt;节点并且使用了ng-modle指令，所以compile还要扫描它并匹配指令，然后绑定监听器。每次循环都做如此多的工作。而更加糟糕的一点是，我们会在程序中向array中添加元素，此时页面上会实时更新DOM，每次有新元素进来，compile函数都把上面的步骤再走一遍，岂不是要累死了，这样性能必然不行。</p><p><br/></p><p>现在扔掉那个假设，在编译的时候compile就只管生成DOM的事，碰到需要绑定监听器的地方先存着，有几个存几个，最后把它们汇总成一个link函数，然后一并执行。这样就轻松多了，compile只需要执行一次，性能自然提升。</p><p><br/></p><p>另外一个区别是能力。</p><p><br/></p><p>尽管compile和link所做的事情差不多，但它们的能力范围还是不一样的。比如正房能管你的存款，小三就不能。小三能给你初恋的感觉，正房却不能。</p><p><br/></p><p>我们需要看一下compile函数和link函数的定义：</p><p><br/></p><p>function compile(tElement, tAttrs, transclude) { ... }</p><p><br/></p><p>function link(scope, iElement, iAttrs, controller) { ... } &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><br/></p><p>这些参数都是通过依赖注入而得到的，可以按需声明使用。从名字也容易看出，两个函数各自的职责是什么，compile可以拿到transclude，允许你自己编程管理乾坤大挪移的行为。而link中可以拿到scope和controller，可以与scope进行数据绑定，与其他指令进行通信。两者虽然都可以拿到element，但是还是有区别的，看到各自的前缀了吧？compile拿到的是编译前的，是从template里拿过来的，而link拿到的是编译后的，已经与作用域建立了</p><p><br/></p><p>关联，这也正是link中可以进行数据绑定的原因。</p><p><br/></p><p>　　我暂时只能理解到这个程度了。实在不想理解这些知识的话，只要简单记住一个原则就行了：如果指令只进行DOM的修改，不进行数据绑定，那么配置在compile函数中，如果指令要进行数据绑定，那么配置在link函数中。</p><p><br/></p><p>6.2.5指令的划分作用域参数：scope</p><p><br/></p><p>我们在上面写了一个简单的&lt;say-hello&gt;&lt;/say-hello&gt;，能够跟美女打招呼。但是看看人家ng内置的指令，都是这么用的：ng-model=”m”，ng-repeat=”a in array”，不单单是作为属性，还可以赋值给它，与作用域中的一个变量绑定好，内容就可以动态变化了。假如我们的sayHello可以这样用：&lt;say-hello speak=”content”&gt;美女&lt;/say-hello&gt;，把要对美女说的话写在一个变量content中，然后只要在controller中修改content的值，页面就可以显示对美女说的不同的话。这样就灵活多了，不至于见了美女只会说一句hello，然后就没有然后。</p><p><br/></p><p>为了实现这样的功能，我们需要使用scope参数，下面来介绍一下。</p><p><br/></p><p>使用scope为指令划分作用域</p><p><br/></p><p>　　顾名思义，scope肯定是跟作用域有关的一个参数，它的作用是描述指令与父作用域的关系，这个父作用域是指什么呢？想象一下我们使用指令的场景，页面结构应该是这个样子：</p><p><br/></p><p>&lt;div ng-controller=&quot;testC&quot;&gt;</p><p><br/></p><p>&nbsp; &nbsp; &lt;say-hello speak=&quot;content&quot;&gt;美女&lt;/say-hello&gt;</p><p><br/></p><p>&lt;/div&gt;　　</p><p><br/></p><p>外层肯定会有一个controller，而在controller的定义中大体是这个样子：</p><p><br/></p><p>var app = angular.module(&#39;MyApp&#39;, [], function(){console.log(&#39;here&#39;)});</p><p><br/></p><p>app.controller(&#39;testC&#39;,function($scope){</p><p><br/></p><p>$scope.content = &#39;今天天气真好！&#39;;</p><p><br/></p><p>});　</p><p><br/></p><p>所谓sayHello的父作用域就是这个名叫testC的控制器所管辖的范围，指令与父作用域的关系可以有如下取值：</p><p><br/></p><p>取值</p><p><br/></p><p>说明</p><p><br/></p><p>false</p><p><br/></p><p>默认值。使用父作用域作为自己的作用域</p><p><br/></p><p>true</p><p><br/></p><p>新建一个作用域，该作用域继承父作用域</p><p><br/></p><p>javascript对象</p><p><br/></p><p>与父作用域隔离，并指定可以从父作用域访问的变量</p><p><br/></p><p>乍一看取值为false和true好像没什么区别，因为取值为true时会继承父作用域，即父作用域中的任何变量都可以访问到，效果跟直接使用父作用域差不多。但细细一想还是有区别的，有了自己的作用域后就可以在里面定义自己的东西，与跟父作用域混在一起是有本质上的区别。好比是父亲的钱你想花多少花多少，可你自己挣的钱父亲能花多少就不好说了。你若想看这两个作用域的区别，可以在link函数中打印出来看看，还记得link函数中可以访问到scope吧。</p><p><br/></p><p>最有用的还是取值为第三种，一个对象，可以用键值来显式的指明要从父作用域中使用属性的方式。当scope值为一个对象时，我们便建立了一个与父层隔离的作用域，不过也不是完全隔离，我们可以手工搭一座桥梁，并放行某些参数。我们要实现对美女说各种话就得靠这个。使用起来像这样：</p><p><br/></p><p>scope: {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; attributeName1: &#39;BINDING_STRATEGY&#39;,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; attributeName2: &#39;BINDING_STRATEGY&#39;,...</p><p><br/></p><p>}　　</p><p><br/></p><p>键为属性名称，值为绑定策略。等等！啥叫绑定策略？最讨厌冒新名词却不解释的行为！别急，听我慢慢道来。</p><p><br/></p><p>&nbsp;</p><p><br/></p><p>　　先说属性名称吧，你是不是认为这个attributeName1就是父作用域中的某个变量名称？错！其实这个属性名称是指令自己的模板中要使用的一个名称，并不对应父作用域中的变量，稍后的例子中我们来说明。再来看绑定策略，它的取值按照如下的规则：</p><p><br/></p><p>符号</p><p><br/></p><p>说明</p><p><br/></p><p>举例</p><p><br/></p><p>@</p><p><br/></p><p>传递一个字符串作为属性的值</p><p><br/></p><p>str : ‘@string’</p><p><br/></p><p>=</p><p><br/></p><p>使用父作用域中的一个属性，绑定数据到指令的属性中</p><p><br/></p><p>name : ‘=username’</p><p><br/></p><p>&amp;</p><p><br/></p><p>使用父作用域中的一个函数,可以在指令中调用</p><p><br/></p><p>getName : ‘&amp;getUserName’</p><p><br/></p><p>　　总之就是用符号前缀来说明如何为指令传值。你肯定迫不及待要看例子了，我们结合例子看一下，小二，上栗子~</p><p><br/></p><p>举例说明</p><p><br/></p><p>我想要实现上面想像的跟美女多说点话的功能，即我们给sayHello指令加一个属性，通过给属性赋值来动态改变说话的内容 主要代码如下：</p><p><br/></p><p>app.controller(&#39;testC&#39;,function($scope){</p><p><br/></p><p>&nbsp; &nbsp;$scope.content = &#39;今天天气真好！&#39;;</p><p><br/></p><p>});</p><p><br/></p><p>app.directive(&#39;sayHello&#39;,function(){</p><p><br/></p><p>&nbsp; &nbsp; return {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; restrict : &#39;E&#39;,</p><p><br/></p><p>template: &#39;&lt;div&gt;hello,&lt;b ng-transclude&gt;&lt;/b&gt;,{{ cont }}&lt;/div&gt;&#39;,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; replace : true,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; transclude : true,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; scope : {</p><p><br/></p><p>&nbsp;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cont : &#39;=speak&#39;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</p><p><br/></p><p>&nbsp; &nbsp; };</p><p><br/></p><p>});</p><p><br/></p><p>然后在模板中，我们如下使用指令：</p><p><br/></p><p>&lt;div ng-controller=&quot;testC&quot;&gt;</p><p><br/></p><p>&nbsp; &nbsp; &lt;say-hello speak=&quot; content &quot;&gt;美女&lt;/say-hello&gt;</p><p><br/></p><p>&lt;/div&gt;</p><p><br/></p><p>看看运行效果：</p><p><br/></p><p>美女今天天气真好！</p><p><br/></p><p>　　执行的流程是这样的：</p><p><br/></p><p>　　① 指令被编译的时候会扫描到template中的{ {cont} }，发现是一个表达式；</p><p><br/></p><p>　　② 查找scope中的规则：通过speak与父作用域绑定，方式是传递父作用域中的属性；</p><p><br/></p><p>　　③ speak与父作用域中的content属性绑定，找到它的值“今天天气真好！”；</p><p><br/></p><p>　　④ 将content的值显示在模板中。</p><p><br/></p><p>这样我们说话的内容content就跟父作用域绑定到了一其，如果动态修改父作用域的content的值，页面上的内容就会跟着改变，正如你点击“换句话”所看到的一样。</p><p><br/></p><p>　　这个例子也太小儿科了吧！简单虽简单，但可以让我们理解清楚，为了检验你是不是真的明白了，可以思考一下如何修改指令定义，能让sayHello以如下两种方式使用：</p><p><br/></p><p>&lt;span say-hello speak=&quot;content&quot;&gt;美女&lt;/span&gt;</p><p><br/></p><p>&lt;span say-hello=&quot;content&quot; &gt;美女&lt;/span&gt;</p><p><br/></p><p>　　答案我就不说了，简单的很。下面有更重要的事情要做，我们说好了要写一个真正能用的东西来着。接下来就结合所学到的东西来写一个折叠菜单，即点击可展开，再点击一次就收缩回去的菜单。</p><p><br/></p><p>控制器及指令的代码如下（例07）：</p><p><br/></p><p>app.controller(&#39;testC&#39;,function($scope){</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; $scope.title = &#39;个人简介&#39;;</p><p><br/></p><p>&nbsp; &nbsp; $scope.text = &#39;大家好，我是一名前端工程师，我正在研究AngularJs，欢迎大家与我交流&#39;;</p><p><br/></p><p>});</p><p><br/></p><p>&nbsp; &nbsp; app.directive(&#39;expander&#39;,function(){</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; return {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; restrict : &#39;E&#39;,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; templateUrl : &#39;expanderTemp.html&#39;,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; replace : true,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; transclude : true,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scope : {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mytitle : &#39;=etitle&#39;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; },</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; link : function(scope,element,attris){</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scope.showText = false;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scope.toggleText = function(){</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scope.showText = ! scope.showText;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; };</p><p><br/></p><p>&nbsp; &nbsp; });</p><p><br/></p><p>HTML中的代码如下：</p><p><br/></p><p>&nbsp;</p><p><br/></p><p>&lt;script type=&quot;text/ng-template&quot; id=&quot;expanderTemp.html&quot;&gt;</p><p><br/></p><p>&nbsp; &nbsp; &lt;div &nbsp;class=&quot;mybox&quot;&gt;</p><p><br/></p><p>&lt;div class=&quot;mytitle&quot; ng-click=&quot;toggleText()&quot;&gt;</p><p><br/></p><p>{{mytitle}}</p><p><br/></p><p>&lt;/div&gt;</p><p><br/></p><p>&lt;div ng-transclude ng-show=&quot;showText&quot;&gt;</p><p><br/></p><p>&lt;/div&gt;</p><p><br/></p><p>&lt;/div&gt;</p><p><br/></p><p>&lt;/script&gt;</p><p><br/></p><p>&lt;div ng-controller=&quot;testC&quot;&gt;</p><p><br/></p><p>&nbsp; &nbsp; &lt;expander etitle=&quot;title&quot;&gt;{{text}}&lt;/expander&gt;</p><p><br/></p><p>&lt;/div&gt;</p><p><br/></p><p>　　还是比较容易看懂的，我只做一点必要的解释。首先我们定义模板的时候使用了ng的一种定义方式&lt;script type=”text/ng-template”id=&quot;expanderTemp.html&quot;&gt;，在指令中就可以用templateUrl根据这个id来找到模板。指令中的{{mytitle}}表达式由scope参数指定从etitle传递，etitle指向了父作用域中的title。为了实现点击标题能够展开收缩内容，我们把这部分逻辑放在了link函数中，link函数可以访问到指令的作用域，我们定义showText属性来表示内容部分的显隐，定义toggleText函数来进行控制，然后在模板中绑定好。 如果把showText和toggleText定义在controller中，作为$scope的属性呢？显然是不行的，这就是隔离作用域的意义所在，父作用域中的东西除了title之外通通被屏蔽。</p><p><br/></p><p>上面的例子中，scope参数使用了=号来指定获取属性的类型为父作用域的属性，如果我们想在指令中使用父作用域中的函数，使用&amp;符号即可，是同样的原理。</p><p><br/></p><p>6.2.6指令间通信参数：controller和require</p><p><br/></p><p>　　使用指令来定义一个ui组件是个不错的想法，首先使用起来方便，只需要一个标签或者属性就可以了，其次是可复用性高，通过controller可以动态控制ui组件的内容，而且拥有双向绑定的能力。当我们想做的组件稍微复杂一点，就不是一个指令可以搞定的了，就需要指令与指令的协作才可以完成，这就需要进行指令间通信。</p><p><br/></p><p>想一下我们进行模块化开发的时候的原理，一个模块暴露（exports）对外的接口，另外一个模块引用（require）它，便可以使用它所提供的服务了。ng的指令间协作也是这个原理，这也正是自定义指令时controller参数和require参数的作用。</p><p><br/></p><p>controller参数用于定义指令对外提供的接口，它的写法如下：</p><p><br/></p><p>&nbsp;</p><p><br/></p><p>controller: function controllerConstructor($scope, $element, $attrs, $transclude)　　</p><p><br/></p><p>它是一个构造器函数，将来可以构造出一个实例传给引用它的指令。为什么叫controller（控制器）呢？其实就是告诉引用它的指令，你可以控制我。至于可以控制那些东西呢，就需要在函数体中进行定义了。先看controller可以使用的参数，作用域、节点、节点的属性、节点内容的迁移，这些都可以通过依赖注入被传进来，所以你可以根据需要只写要用的参数。关于如何对外暴露接口，我们在下面的例子来说明。</p><p><br/></p><p>require参数便是用来指明需要依赖的其他指令，它的值是一个字符串，就是所依赖的指令的名字，这样框架就能按照你指定的名字来从对应的指令上面寻找定义好的controller了。不过还稍稍有点特别的地方，为了让框架寻找的时候更轻松些，我们可以在名字前面加个小小的前缀：^，表示从父节点上寻找，使用起来像这样：require : ‘^directiveName’，如果不加，$compile服务只会从节点本身寻找。另外还可以使用前缀：？，此前缀将告诉$compile服务，如果所需的controller没找到，不要抛出异常。</p><p><br/></p><p>所需要了解的知识点就这些，接下来是例子时间，依旧是从书上抄来的一个例子，我们要做的是一个手风琴菜单，就是多个折叠菜单并列在一起，此例子用来展示指令间的通信再合适不过。</p><p><br/></p><p>首先我们需要定义外层的一个结构，起名为accordion，代码如下：</p><p><br/></p><p>app.directive(&#39;accordion&#39;,function(){</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; return {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; restrict : &#39;E&#39;,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; template : &#39;&lt;div ng-transclude&gt;&lt;/div&gt;&#39;,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; replace : true,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; transclude : true,</p><p><br/></p><p>controller :function(){</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var expanders = [];</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.gotOpended = function(selectedExpander){</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; angular.forEach(expanders,function(e){</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(selectedExpander != e){</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e.showText = false;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; });</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.addExpander = function(e){</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; expanders.push(e);</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p><br/></p><p>&nbsp; &nbsp; });</p><p><br/></p><p>需要解释的只有controller中的代码，我们定义了一个折叠菜单数组expanders，并且通过this关键字来对外暴露接口，提供两个方法。gotOpended接受一个selectExpander参数用来修改数组中对应expander的showText属性值，从而实现对各个子菜单的显隐控制。addExpander方法对外提供向expanders数组增加元素的接口，这样在子菜单的指令中，便可以调用它把自身加入到accordion中。</p><p><br/></p><p>看一下我们的expander需要做怎样的修改呢：</p><p><br/></p><p>app.directive(&#39;expander&#39;,function(){</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; return {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; restrict : &#39;E&#39;,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; templateUrl : &#39;expanderTemp.html&#39;,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; replace : true,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; transclude : true,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; require : &#39;^?accordion&#39;,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scope : {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; title : &#39;=etitle&#39;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; },</p><p><br/></p><p>&nbsp;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; link : function(scope,element,attris,accordionController){</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scope.showText = false;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; accordionController.addExpander(scope);</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scope.toggleText = function(){</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scope.showText = ! scope.showText;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; accordionController.gotOpended(scope);</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; };</p><p><br/></p><p>&nbsp; &nbsp; });</p><p><br/></p><p>首先使用require参数引入所需的accordion指令，添加?^前缀表示从父节点查找并且失败后不抛出异常。然后便可以在link函数中使用已经注入好的accordionController了，调用addExpander方法将自己的作用域作为参数传入，以供accordionController访问其属性。然</p><p><br/></p><p>后在toggleText方法中，除了要把自己的showText修改以外，还要调用accordionController的gotOpended方法通知父层指令把其他菜单给收缩起来。</p><p><br/></p><p>指令定义好后，我们就可以使用了，使用起来如下：</p><p><br/></p><p>&nbsp;</p><p><br/></p><p>&lt;accordion&gt;</p><p><br/></p><p>&lt;expander ng-repeat=&quot;expander in expanders&quot; etitle=&quot;expander.title&quot;&gt;&nbsp;</p><p><br/></p><p>{{expander.text}}&nbsp;</p><p><br/></p><p>&lt;/expander&gt;</p><p><br/></p><p>&lt;/accordion&gt;　　</p><p><br/></p><p>外层使用了accordion指令，内层使用expander指令，并且在expander上用ng-repeat循环输出子菜单。请注意这里遍历的数组expanders可不是accordion中定义的那个expanders，如果你这么认为了，说明还是对作用域不够了解。此expanders是ng-repeat的值，它是在外层controller中的，所以，在testC中，我们需要添加如下数据：</p><p><br/></p><p>$scope.expanders = [</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {title: &#39;个人简介&#39;,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;text: &#39;大家好，我是一名前端工程师，我正在研究AngularJs，欢迎大家与我交流&#39;},</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {title: &#39;我的爱好&#39;,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;text: &#39;LOL &#39;},</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {title: &#39;性格&#39;,</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;text: &#39; 我的性格就是无性格&#39;}</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; ];</p><p><br/></p><p>6.3 性能及调优</p><p><br/></p><p>6.3.1性能测试</p><p><br/></p><p>AnglarJS作为一款优秀的Web框架，可大大简化前端开发的负担。</p><p><br/></p><p>AnglarJS很棒，但当处理包含复杂数据结构的大型列表时，其运行速度就会非常慢。</p><p><br/></p><p>这是我们将核心管理页面迁移到AngularJS过程中遇到的问题。这些页面在显示500行数据时本应该工作顺畅，但首个方法的渲染时间竟花费了7秒，太可怕了。后来，我们发现了在实现过程中存在两个主要性能问题。一个与“ng-repeat ”指令有关，另一个与过滤器有关。</p><p><br/></p><p>AngularJS 中的ng-repeat在处理大型列表时，速度为什么会变慢？&nbsp;</p><p><br/></p><p>AngularJS中的ng-repeat在处理2500个以上的双向数据绑定时速度会变慢。这是由于AngularJS通过“dirty checking”函数来检测变化。每次检测都会花费时间，所以包含复杂数据结构的大型列表将降低你应用的运行速度。</p><p><br/></p><p>提高性能的先决条件&nbsp;</p><p><br/></p><p>时间记录指令&nbsp;</p><p><br/></p><p>为了测量一个列表渲染所花费的时间，我们写了一个简单的程序，通过使用“ng-repeat”的属性“$last”来记录时间。时间存放在TimeTracker服务中，这样时间记录就与服务器端的数据加载分开了。</p><p><br/></p><p>// Post repeat directive for logging the rendering time &nbsp;&nbsp;</p><p><br/></p><p>angular.module(&#39;siApp.services&#39;).directive(&#39;postRepeatDirective&#39;, &nbsp;&nbsp;</p><p><br/></p><p>[&#39;$timeout&#39;, &#39;$log&#39;, &nbsp;&#39;TimeTracker&#39;, &nbsp;&nbsp;</p><p><br/></p><p>&nbsp; function($timeout, $log, TimeTracker) { &nbsp;</p><p><br/></p><p>&nbsp; &nbsp; return function(scope, element, attrs) { &nbsp;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; if (scope.$last){ &nbsp;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$timeout(function(){ &nbsp;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var timeFinishedLoadingList = TimeTracker.reviewListLoaded(); &nbsp;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var ref = new Date(timeFinishedLoadingList); &nbsp;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var end = new Date(); &nbsp;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$log.debug(&quot;## DOM rendering list took: &quot; + (end - ref) + &quot; ms&quot;); &nbsp;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}); &nbsp;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp;} &nbsp;</p><p><br/></p><p>&nbsp; &nbsp; }; &nbsp;</p><p><br/></p><p>&nbsp; } &nbsp;</p><p><br/></p><p>]); &nbsp;</p><p><br/></p><p>// Use in HTML: &nbsp;&nbsp;</p><p><br/></p><p>&lt;tr ng-repeat=&quot;item in items&quot; post-repeat-directive&gt;…&lt;/tr&gt; &nbsp;</p><p><br/></p><p>Chrome开发者工具的时间轴（Timeline）属性&nbsp;</p><p><br/></p><p>在Chrome开发者工具的时间轴标签中，你可以看见事件、每秒内浏览器帧数和内存分配。“memory”工具用来检测内存泄漏，及页面所需的内存。当帧速率每秒低于30帧时就会出现页面闪烁问题。“frames”工具可帮助了解渲染性能，还可显示出一个JavaScript任务所花费的CPU时间。</p><p><br/></p><p>通过限制列表的大小进行基本的调优&nbsp;</p><p><br/></p><p>缓解该问题，最好的办法是限制所显示列表的大小。可通过分页、添加无限滚动条来实现。</p><p><br/></p><p>分页，我们可以使用AngularJS的“limitTo”过滤器（AngularJS1.1.4版本以后）和“startFrom”过滤器。可以通过限制显示列表的大小来减少渲染时间。这是减少渲染时间最高效的方法。</p><p><br/></p><p>6.3.2七大调优法则&nbsp;</p><p><br/></p><p>1.渲染没有数据绑定的列表&nbsp;</p><p><br/></p><p>这是最明显的解决方案，因为数据绑定是性能问题最可能的根源。如果你只想显示一次列表，并不需要更新、改变数据，放弃数据绑定是绝佳的办法。不过可惜的是，你会失去对数据的控制权，但除了该法，我们别无选择。</p><p><br/></p><p>2.不要使用内联方法计算数据&nbsp;</p><p><br/></p><p>为了在控制器中直接过滤列表，不要使用可获得过滤链接的方法。“ng-repeat”会评估每个表达式。在我们的案例中，“filteredItems()”返回过滤链接。如果评估过程很慢，它将迅速降低整个应用的速度。</p><p><br/></p><p>&nbsp;</p><p><br/></p><p>l &lt;li ng-repeat=&quot;item in filteredItems()&quot;&gt; //这并不是一个好方法，因为要频繁地评估。 &nbsp;&nbsp;</p><p><br/></p><p>l &lt;li ng-repeat=&quot;item in items&quot;&gt; //这是要采用的方法 &nbsp;</p><p><br/></p><p>3.使用两个列表（一个用来进行视图显示，一个作为数据源）&nbsp;</p><p><br/></p><p>将要显示的列表与总的数据列表分开，是非常有用的模型。你可以对一些过滤进行预处理，并将存于缓存中的链接应用到视图上。下面案例展示了基本实现过程。filteredLists变量保存着缓存中的链接，applyFilter方法来处理映射。</p><p><br/></p><p>/* Controller */ &nbsp;</p><p><br/></p><p>// Basic list &nbsp; &nbsp;</p><p><br/></p><p>var items = [{name:&quot;John&quot;, active:true }, {name:&quot;Adam&quot;}, {name:&quot;Chris&quot;}, {name:&quot;Heather&quot;}]; &nbsp; &nbsp;</p><p><br/></p><p>// Init displayedList &nbsp;&nbsp;</p><p><br/></p><p>$scope.displayedItems = items; &nbsp;</p><p><br/></p><p>// Filter Cache &nbsp;&nbsp;</p><p><br/></p><p>var filteredLists[&#39;active&#39;] = $filter(&#39;filter)(items, {&quot;active&quot; : true}); &nbsp;</p><p><br/></p><p>// Apply the filter &nbsp;&nbsp;</p><p><br/></p><p>$scope.applyFilter = function(type) { &nbsp;</p><p><br/></p><p>&nbsp; &nbsp; if (filteredLists.hasOwnProperty(type){ // Check if filter is cached &nbsp;&nbsp;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp;$scope.displayedItems = filteredLists[type]; &nbsp;</p><p><br/></p><p>&nbsp; &nbsp; } else { &nbsp;&nbsp;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; /* Non cached filtering */ &nbsp;</p><p><br/></p><p>&nbsp; &nbsp; } &nbsp;</p><p><br/></p><p>} &nbsp;</p><p><br/></p><p>// Reset filter &nbsp;&nbsp;</p><p><br/></p><p>$scope.resetFilter = function() { &nbsp;</p><p><br/></p><p>&nbsp; &nbsp; $scope.displayedItems = items; &nbsp;</p><p><br/></p><p>} &nbsp;</p><p><br/></p><p>/* View */ &nbsp;</p><p><br/></p><p>&lt;button ng-click=&quot;applyFilter(&#39;active&#39;)&quot;&gt;Select active&lt;/button&gt; &nbsp;</p><p><br/></p><p>&lt;ul&gt;&lt;li ng-repeat=&quot;item in displayedItems&quot;&gt;{{item.name}}&lt;li&gt;&lt;/ul&gt; &nbsp;</p><p><br/></p><p>4.在其他模板中使用ng-if来代替ng-show&nbsp;</p><p><br/></p><p>如果你用指令、模板来渲染额外的信息，例如通过点击来显示列表项的详细信息，一定要使用 &nbsp;ng-if（AngularJSv. 1.1.5以后）。ng-if可阻止渲染（与ng-show相比）。所以其它DOM和数据绑定可根据需要进行评估。</p><p><br/></p><p>&lt;li ng-repeat=&quot;item in items&quot;&gt; &nbsp;</p><p><br/></p><p>&nbsp;</p><p><br/></p><p>&nbsp; &nbsp;&lt;p&gt; {{ item.title }} &lt;/p&gt; &nbsp;</p><p><br/></p><p>&nbsp; &nbsp;&lt;button ng-click=&quot;item.showDetails = !item.showDetails&quot;&gt;Show details&lt;/buttons&gt; &nbsp;</p><p><br/></p><p>&nbsp; &nbsp;&lt;div ng-if=&quot;item.showDetails&quot;&gt; &nbsp;</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp;{{item.details}} &nbsp;</p><p><br/></p><p>&nbsp; &nbsp;&lt;/div&gt; &nbsp;</p><p><br/></p><p>&lt;/li&gt; &nbsp;</p><p><br/></p><p>5.不要使用ng-mouseenter、ng-mouseleave等指令&nbsp;</p><p><br/></p><p>使用内部指令，像ng-mouseenter，AngularJS会使你的页面闪烁。浏览器的帧速率通常低于每秒30帧。使用jQuery创建动画、鼠标悬浮效果可以解决该问题。确保将鼠标事件放入jQuery的.live()函数中。</p><p><br/></p><p>6.关于过滤的小提示：通过ng-show隐藏多余的元素&nbsp;</p><p><br/></p><p>对于长列表，使用过滤同样会减低工作效率，因为每个过滤都会创建一个原始列表的子链接。在很多情况下，数据没有变化，过滤结果也会保持不变。所以对数据列表进行预过滤，并根据情况将它应用到视图中，会大大节约处理时间。</p><p><br/></p><p>在ng-repeat指令中使用过滤器，每个过滤器会返回一个原始链接的子集。AngularJS 从DOM中移除多余元素（通过调用 $destroy），同时也会从$scope中移除他们。当过滤器的输入发生改变时，子集也会随着变化，元素必须进行重新链接，或着再调用$destroy。</p><p><br/></p><p>大部分情况下，这样做很好，但一旦用户经常过滤，或者列表非常巨大，不断的链接与</p><p><br/></p><p>销毁将影响性能。为了加快过滤的速度，你可以使用ng-show和ng-hide指令。在控制器中，进行过滤，并为每项添加一个属性。依靠该属性来触发ng-show。结果是，只为这些元素增加ng-hide类，来代替将它们移除子列表、$scope和DOM。</p><p><br/></p><p>触发ng-show的方法之一是使用表达式语法。ng-show的值由表达式语法来确定。可以看下面的例子：</p><p><br/></p><p>&lt;input ng-model=&quot;query&quot;&gt;&lt;/input&gt; &nbsp;</p><p><br/></p><p>&lt;li ng-repeat=&quot;item in items&quot; ng-show=&quot;([item.name] | filter:query).length&quot;&gt; {{item.name}} &lt;/li&gt;</p><p><br/></p><p>&lt;span style=&quot;font-size: 14px; line-height: 24px; font-family:; white-space: normal;&quot;&gt;&lt;/span&gt;&nbsp;</p><p><br/></p><p>7.关于过滤的小提示：防抖动输入</p><p><br/></p><p>解决第6点提出的持续过滤问题的另一个方法是防抖动用户输入。例如，如果用户输入一个搜索关键词，只当用户停止输入后，过滤器才会被激活。使用该防抖动服务的一个很好的解决方案请见： http://jsfiddle.net/Warspawn/6K7Kd/。将它应用到你的视图及控制器中，如下所示：</p><p><br/></p><p>/* Controller */ &nbsp;</p><p><br/></p><p>// Watch the queryInput and debounce the filtering by 350 ms. &nbsp;&nbsp;</p><p><br/></p><p>$scope.$watch(&#39;queryInput&#39;, function(newValue, oldValue) { &nbsp;</p><p><br/></p><p>&nbsp; &nbsp; if (newValue === oldValue) { return; } &nbsp;</p><p><br/></p><p>&nbsp; &nbsp; $debounce(applyQuery, 350); &nbsp;</p><p><br/></p><p>}); &nbsp;</p><p><br/></p><p>var applyQuery = function() { &nbsp;&nbsp;</p><p><br/></p><p>&nbsp; &nbsp; $scope.filter.query = $scope.query; &nbsp;</p><p><br/></p><p>}; &nbsp; &nbsp;</p><p><br/></p><p>/* View */ &nbsp;</p><p><br/></p><p>&lt;input ng-model=&quot;queryInput&quot;/&gt; &nbsp;</p><p><br/></p><p>&lt;li ng-repeat= item in items | filter:filter.query&gt;{{ item.title }} &lt;/li&gt;&nbsp;</p><p><br/></p><p>&nbsp;</p><p><br/></p><p>7 总结</p><p>angular上手比较难，初学者（特别是习惯了使用JQuery的人）可能不太适应其语法以及思想。随着对ng探索的一步步深入，也确实感觉到了这一点，尤其是框架内部的某些执行机制。</p><p><br/></p><p>7.1页面效果</p><p><br/></p><p>&nbsp;ng-show ng-hide 无动画效果问题</p><p><br/></p><p>7.2委派事件（代理事件）</p><p><br/></p><p>7.2.1 NG循环及事件绑定</p><p><br/></p><p>&lt;ul&gt;</p><p><br/></p><p>&nbsp; &lt;li ng-repeat=&quot;a in array&quot;&gt;</p><p><br/></p><p>&nbsp; &nbsp; &lt;input ng-modle=”a.m” /&gt;</p><p><br/></p><p>&nbsp; &lt;/li&gt;</p><p><br/></p><p>&lt;/ul&gt;</p><p><br/></p><p>Ng会根据array的长度复制出n个&lt;li&gt;标签。而复制出的&lt;li&gt;节点中还有&lt;input&gt;节点并且使用了ng-modle指令，所以ng会对所有的&lt;input&gt;绑定监听器（事件）。如果array很大，就会绑定太多的事件，性能出现问题。</p><p><br/></p><p>7.2.2 jQuery委派事件</p><p><br/></p><p>&nbsp;</p><p><br/></p><p>从jQuery1.7开始，提供了.on()附加事件处理程序。</p><p><br/></p><p>.on( events [, selector ] [, data ], handler(eventObject) )&nbsp;</p><p><br/></p><p>参数Selector为一个选择器字符串，用于过滤出被选中的元素中能触发事件的后代元素。如果选择器是 null 或者忽略了该选择器，那么被选中的元素总是能触发事件。</p><p><br/></p><p>如果省略selector或者是null，那么事件处理程序被称为直接事件 或者 直接绑定事件 。每次选中的元素触发事件时，就会执行处理程序，不管它直接绑定在元素上，还是从后代（内部）元素冒泡到该元素的。</p><p><br/></p><p>当提供selector参数时，事件处理程序是指为委派事件（代理事件）。事件不会在直接绑定的元素上触发，但当selector参数选择器匹配到后代（内部元素）的时候，事件处理函数才会被触发。jQuery 会从 event target 开始向上层元素(例如，由最内层元素到最外层元素)开始冒泡，并且在传播路径上所有绑定了相同事件的元素若满足匹配的选择器，那么这些元素上的事件也会被触发。</p><p><br/></p><p>委托事件有两个优势：他们能在后代元素添加到文档后，可以处理这些事件；代理事件的另一个好处就是，当需要监视很多元素的时候，代理事件的开销更小。</p><p><br/></p><p>例如，在一个表格的 tbody 中含有 1,000 行，下面这个例子会为这 1,000 元素绑定事</p><p><br/></p><p>$(&quot;#dataTable tbody tr&quot;).on(&quot;click&quot;, function(event){ alert($(this).text());});&nbsp;</p><p><br/></p><p>委派事件的方法只有一个元素的事件处理程序，tbody，并且事件只会向上冒泡一层（从被点击的tr 到 tbody ）:</p><p><br/></p><p>$(&quot;#dataTable tbody&quot;).on(&quot;click&quot;, &quot;tr&quot;, function(event){ &nbsp;alert($(this).text());});&nbsp;</p><p><br/></p><p>许多委派的事件处理程序绑定到 document 树的顶层附近，可以降低性能。每次发生事件时，jQuery 需要比较从 event target（目标元素） 开始到文档顶部的路径中每一个元素上所有该类型的事件。为了获得更好的性能，在绑定代理事件时，绑定的元素最好尽可能的靠近目标元素。避免在大型文档中，过多的在 document 或 document.body 上添加代理事件。</p><p><br/></p>
                                    </td>
                                </tr>
                            </table>
							
							
							
                            <table class="tb_title" style="margin: 5px auto 5px auto;">
                                <tr>
                                    <td class="tdright" id="bottomoption">
                                        <a href="/ac/tx/xuyuanqiang/">复制链接</a> <a href="/ac/tx/xuyuanqiang/">网友评论</a> <a href="#" onclick="addCookie('如何学习AngularJS_夜鹰教程网欢迎您!','http://www.yyjcw.com');return false;">
                                            收藏本文</a> <a href="###" onclick="window.close()">关闭此页</a>
                                    </td>
                                </tr>
                            </table>
                            <table class="tb_title" style="margin: 5px auto 5px auto;">
                                <tr>
                                    <td class="td_brief tdcenter" style="width: 100%;">
                                        上一条： <a href="/html/News/1804.html">使用自定义指令当ng-repeat加载完…</a>&nbsp;&nbsp;下一条： <a href="/html/News/1778.html">Angular 事件</a>
                                    </td>
                                </tr>
                            </table>
							<table class="tb_title">
                                <tr>
                                    <td class="td_brief" style="border: solid 1px #ccc; width: 100%;">
                                        
                                        <a href="http://www.yyjcw.com/list.html">购买夜鹰教程网视频教程</a>
                                    </td>
                                </tr>
                            </table>
							<table class="tb_title">
                                <tr>
                                    <td class="td_brief" style="border: solid 1px #ccc; width: 100%;">
                                   <ul style="width:100%; clear:both;" id="RelationList"><li><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1804.html" title="使用自定义指令当ng-repeat加载完数据后执行js方法" >使用自定义指令当ng-repeat加…</a></li><li><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1779.html" title="如何学习AngularJS" >如何学习AngularJS</a></li><li><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1778.html" title="Angular 事件" >Angular 事件</a></li><li><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1777.html" title="AngularJS 指令" >AngularJS 指令</a></li><li><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1650.html" title="对比四种给百度搜索引擎提交链接的方法" >对比四种给百度搜索引擎提交链…</a></li><li><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1370.html" title="网站原创内容过少可能导致AdSense屏蔽你的广告帐号" >网站原创内容过少可能导致AdS…</a></li><li><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1359.html" title="户端的优化越来越受到关注" >户端的优化越来越受到关注</a></li><li><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1356.html" title="百度新闻源的采集收录标准是什么" >百度新闻源的采集收录标准是什…</a></li><li><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1353.html" title="SEO和SEM是目前最直接有效的方法" >SEO和SEM是目前最直接有效的方…</a></li></ul>
                                    </td>
                                </tr>
                            </table>
							
                        </td>
                        <td align="center" valign="top" class="tdboder_ccc" id="nei_content_right">
							 <table cellspacing="0" cellpadding="0" class="nei_rightList">
                                <tr>
                                    <td align="left" valign="middle" class="c_title">
                                        &nbsp;<img src="/images/nei_title.gif" alt="" />&nbsp;<a href="/list.html">热门服务</a>/<a href="/mulu.html">教程目录</a>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="nei_Right_Content">
                                    <br/>
                                    <div style="line-height:24px;">&nbsp;&nbsp;<img alt="夜鹰教程网" align="absMiddle" src="/images/arr11.gif" />&nbsp;<a title="购买全套asp.net(c#)视频教程" target="_blank" href="/html/News/AboutUs_8.html">&nbsp;新手必看，详细又全面。</a><br />
&nbsp;&nbsp;<img alt="夜鹰教程网" align="absMiddle" src="/images/arr11.gif" />&nbsp;<a target="_blank" href="/tuangou.html">&nbsp;购买教程</a>&nbsp;&nbsp;<img alt="夜鹰教程网" align="absMiddle" src="/images/arr11.gif" />&nbsp;<a title="购买全套asp.net(c#)视频教程" target="_blank" href="/list.html">&nbsp;在线支付-方便</a><br />
&nbsp;&nbsp;<img alt="夜鹰教程网" align="absMiddle" src="/images/arr11.gif" />&nbsp;<a title="购买全套asp.net(c#)视频教程" target="_blank" href="/list.html">&nbsp;担保交易-快捷安全</a> &nbsp;&nbsp;<img alt="夜鹰教程网" align="absMiddle" src="/images/arr11.gif" />&nbsp;<a title="购买全套asp.net(c#)视频教程" target="_blank" href="/tuangou.html">&nbsp;闪电发货</a><br />
&nbsp;&nbsp;<img alt="夜鹰教程网" align="absMiddle" src="/images/arr11.gif" />&nbsp;<a title="购买全套asp.net(c#)视频教程" target="_blank" href="/tuangou.html">&nbsp;电话和QQ随时可以联系我们。</a><br/>&nbsp;&nbsp;<img alt="夜鹰教程网" align="absMiddle" src="/images/arr11.gif" />&nbsp;不会的功能都可以找我们，按工作量收费。<br />
</div>
<div style="BORDER-BOTTOM: green 1px solid; TEXT-ALIGN: center; BORDER-LEFT: green 1px solid; MARGIN: 10px auto 0px; WIDTH: 236px; BORDER-TOP: green 1px solid; BORDER-RIGHT: green 1px solid">
<h3 style="FONT-SIZE: 18px">客服电话：153 9760 0032</h3>
购买教程QQ：1416759661&nbsp;&nbsp;<a style="DISPLAY: inline" onclick="var tempSrc='http://sighttp.qq.com/wpa.js?rantime='+Math.random()+'&amp;sigkey=05a95cdf3fa1602e580171226ada682ed2d4a1cb451bf047f1e4969e5fc7b62d';var oldscript=document.getElementById('testJs');var newscript=document.createElement('script');newscript.setAttribute('type','text/javascript'); newscript.setAttribute('id', 'testJs');newscript.setAttribute('src',tempSrc);if(oldscript == null){document.body.appendChild(newscript);}else{oldscript.parentNode.replaceChild(newscript, oldscript);}return false;" target="_blank" href="http://sighttp.qq.com/cgi-bin/check?sigkey=05a95cdf3fa1602e580171226ada682ed2d4a1cb451bf047f1e4969e5fc7b62d"><img border="0" alt="购买教程" src="http://wpa.qq.com/pa?p=1:1416759661:10" /></a>
</div>
                                    </td>
                                </tr>
                            </table>
                            <table cellspacing="0" cellpadding="0" class="nei_rightList">
                                <tr>
                                    <td align="left" valign="middle" class="c_title">
                                        &nbsp;<img src="/images/nei_title.gif" alt="" />&nbsp;<a href="/html/News/NewsList_2_1.html">热点推荐</a>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="nei_Right_Content">
                                        <table style="margin: 5px 0 5px 0"><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/261.html" title="Google搜索存在的的结果变量问题：永远看不到的第173个结果">Google搜索存在的的结果变量问题：…</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1181.html" title="做黑链可以很快的提高排名,但是也很容易被K">做黑链可以很快的提高排名,但是也…</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/661.html" title="被alexa收录的网站如何修改自己在alexa的网站信息">被alexa收录的网站如何修改自己在…</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1249.html" title="CPA广告&nbsp;CPS广告&nbsp;CPC广告&nbsp;CPM广告分别什么意思">CPA广告 CPS广告 CPC广告 CPM广告…</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/262.html" title="如何获得大量优质外链">如何获得大量优质外链</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/264.html" title="内容更新频率与搜索引擎关系&nbsp;让它熟悉你">内容更新频率与搜索引擎关系 让它…</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/259.html" title="如何走出百度首页降权的阴影">如何走出百度首页降权的阴影</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/263.html" title="新站一天被收录的经历">新站一天被收录的经历</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/257.html" title="谈谈做交叉链接的经验心得">谈谈做交叉链接的经验心得</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/260.html" title="新站提前被百度收录需要注意的几点">新站提前被百度收录需要注意的几点…</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1069.html" title="互联钱靠什么？">互联钱靠什么？</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/930.html" title="QQ赚钱方法解密">QQ赚钱方法解密</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/258.html" title="如何使新站1-3天内被百度收录">如何使新站1-3天内被百度收录</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/256.html" title="要怎样解决百度快照长时间不更新">要怎样解决百度快照长时间不更新</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/265.html" title="百度、谷歌搜索引擎原理及新网站应对">百度、谷歌搜索引擎原理及新网站应…</a></td></tr></table>
                                    </td>
                                </tr>
                            </table>
							
                              <table cellspacing="0" cellpadding="0" class="nei_rightList">
                                <tr>
                                    <td align="left" valign="middle" class="c_title">
                                        &nbsp;<img src="/images/nei_title.gif" alt="" />&nbsp;<a href="/ac/vip/">尊贵服务</a>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="nei_Right_Content">
                                        <a href="/ac/vip/" style=" margin-left:5px; margin-top:5px; float:left;"><img src="/images/zq.jpg" alt="夜鹰教程网 承接业务：软件开发 网站开发 网页设计 .Net+C#+VS2008+MSsql+Jquery+ExtJs" style="width:258px; border:0;" /></a><a href="/tuangou.html" style="display:block;clear:both; line-height:24px; font-family:微软雅黑; text-align:center; ">夜鹰教程祝福大家新年快乐</a>
                                    </td>
                                </tr>
                            </table>
                            <table cellspacing="0" cellpadding="0" class="nei_rightList">
                                <tr>
                                    <td align="left" valign="middle" class="c_title">
                                        &nbsp;<img src="/images/nei_title.gif" alt="" />&nbsp;<a href="/news/NewsList.aspx?ClassID=24" title="最便宜的网站建设_视频教程_FLASH__ASP_ASP.NET_SQL2000_SQL2005_AJAX_FLEX_3ds max_Photoshop cs4_夜鹰教程网_www.yyjcw.com">最近更新</a>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="nei_Right_Content">
                                        <table style="margin: 5px 0 5px 0"><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1804.html" title="使用自定义指令当ng-repeat加载完数据后执行js方法" >使用自定义指令当ng-repeat加载完…</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1779.html" title="如何学习AngularJS" >如何学习AngularJS</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1778.html" title="Angular&nbsp;事件" >Angular 事件</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1777.html" title="AngularJS&nbsp;指令" >AngularJS 指令</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1650.html" title="对比四种给百度搜索引擎提交链接的方法" >对比四种给百度搜索引擎提交链接的…</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1370.html" title="网站原创内容过少可能导致AdSense屏蔽你的广告帐号" >网站原创内容过少可能导致AdSense…</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1359.html" title="户端的优化越来越受到关注" >户端的优化越来越受到关注</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1356.html" title="百度新闻源的采集收录标准是什么" >百度新闻源的采集收录标准是什么</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1353.html" title="SEO和SEM是目前最直接有效的方法" >SEO和SEM是目前最直接有效的方法</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1260.html" title="如何提交亚马逊分类目录" >如何提交亚马逊分类目录</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1249.html" title="CPA广告&nbsp;CPS广告&nbsp;CPC广告&nbsp;CPM广告分别什么意思" >CPA广告 CPS广告 CPC广告 CPM广告…</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1238.html" title="月经贴：每次&nbsp;PR&nbsp;值更新就是站长们的“悲喜月”" >月经贴：每次 PR 值更新就是站长们…</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1237.html" title="成功的SEO:如何才能正确分析竞争对手并且超越他" >成功的SEO:如何才能正确分析竞争对…</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1218.html" title="SEO经验之谈：关键词用什么分割？" >SEO经验之谈：关键词用什么分割？…</a></td></tr><tr><td style="line-height: 24px;"><img src="/images/arrow2.gif" alt="" style="margin-left: 3px;" /><a href="/html/News/1209.html" title="从书籍的畅销再谈网站优化" >从书籍的畅销再谈网站优化</a></td></tr></table>
                                    </td>
                                </tr>
                            </table>
                            <table cellspacing="0" cellpadding="0" class="nei_rightList">
                                <tr>
                                    <td align="left" valign="middle" class="c_title">
                                        &nbsp;<img src="/images/nei_title.gif" alt="" />&nbsp;<a href="/aboutus/AboutUs.aspx?id=10" title="最便宜的网站建设_视频教程_FLASH__ASP_ASP.NET_SQL2000_SQL2005_AJAX_FLEX_3ds max_Photoshop cs4_夜鹰教程网_www.yyjcw.com">工具下载</a>&nbsp;&nbsp;需要远程协助?&nbsp;<a style="DISPLAY: inline" onclick="var tempSrc='http://sighttp.qq.com/wpa.js?rantime='+Math.random()+'&amp;sigkey=05a95cdf3fa1602e580171226ada682ed2d4a1cb451bf047f1e4969e5fc7b62d';var oldscript=document.getElementById('testJs');var newscript=document.createElement('script');newscript.setAttribute('type','text/javascript'); newscript.setAttribute('id', 'testJs');newscript.setAttribute('src',tempSrc);if(oldscript == null){document.body.appendChild(newscript);}else{oldscript.parentNode.replaceChild(newscript, oldscript);}return false;" target="_blank" href="http://sighttp.qq.com/cgi-bin/check?sigkey=05a95cdf3fa1602e580171226ada682ed2d4a1cb451bf047f1e4969e5fc7b62d"><img border="0" alt="购买教程" src="http://wpa.qq.com/pa?p=1:1416759661:10" /></a>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="nei_Right_Content ">
                                    <div style=" margin-top:3px; margin-left:3px; ">
                                      <p><a target="_blank" href="http://www.yyjcw.com/html/News/1461.html"><span style="color:#0000ff;font-size:12px"><strong>sql2008视频教程</strong></span></a>&nbsp;<a target="_blank" href="http://www.yyjcw.com/list.html"><span style="color:#0000ff;font-size:12px"><strong>c#视频教程</strong></span></a><br/></p><h3>VIP服务：如果您的某个功能不会做，可以加我们QQ，给你做DEMO！</h3><h3><a target="_blank" href="http://www.yyjcw.com/tuangou.html" style="font-size: 16px;">JQUERY</a>&nbsp;<a target="_blank" href="http://www.yyjcw.com/tuangou.html" style="font-size: 16px;">中文排名第51888位</a><span style="font-size: 16px;"> </span><span style="font-size: 16px; color: rgb(0, 0, 255);"><a href="http://www.yyjcw.com/tuangou.html"><span style="font-size:12px"><strong>Asp.net教程</strong></span></a></span></h3><p><span style="color:#0000ff"><strong><span style="font-size:12px"><a href="http://www.yyjcw.com/html/News/1582.html">MVC视频教程</a>&nbsp;</span></strong></span> <a target="_blank" href="http://www.yyjcw.com/tuangou.html">vs2010<br/></a><strong><span style="color:#0000ff;font-size:12px"><a href="http://www.yyjcw.com/tuangou.html">.NET+sql开发、同行业最低价&nbsp; </a><a href="http://www.yyjcw.com/ac/lucky/">幸运大抽奖</a><br/></span></strong><span style="color:#0000ff">手机：15397600032 </span><a target="_blank" href="http://www.yyjcw.com/tuangou.html"><span style="color:#0000ff">C#视频教程下载</span></a><br/><a target="_blank" href="http://www.yyjcw.com/tuangou.html">vs2012</a> <a target="_blank" href="http://www.yyjcw.com/html/News/AboutUs_3.html">vs2008</a> <a target="_blank" href="http://www.yyjcw.com/tuangou.html">vs2010</a> <a target="_blank" href="http://www.yyjcw.com/tuangou.html">sql2008</a>&nbsp;<a target="_blank" href="http://www.yyjcw.com/tuangou.html">sql2005</a><br/><a target="_blank" href="http://www.yyjcw.com/tuangou.html">Asp.Net <span style="color:#ff0000;font-size:16px"><strong>购买</strong></span> <br/></a><a style="COLOR: red; FONT-SIZE: 14px" target="_blank" href="http://www.yyjcw.com/ting.html">视频教程试听</a>购买教程QQ:1416759661</p><p><br/></p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                            
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
</table>
<div class="outcontainer" style="border: solid 1px white;border-left:0;border-right: 0;">
<div class="incontainner indexnews">
<div style="margin: 10px;">
<p><img src="/images/2Code.jpg" style="float:right;"/></p><p><span style="color: rgb(192, 80, 77); font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">计算机技术辅导。</span></p><p><span style="color: rgb(192, 80, 77); font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">QQ：1416759661 &nbsp; 新手求救QQ群：7835003</span></p><p><span style="color: rgb(192, 80, 77); font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">如果您遇到技术难题，</span><span style="color: rgb(192, 80, 77); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">需要远程调试都可以加我们QQ</span></p><p>技术咨询： <a target="_blank" href="http://www.taobao.com/webww/ww.php?ver=3&touid=%E5%A4%9C%E9%B9%B0%E9%97%AA%E5%AE%A2%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B%E7%BD%91&siteid=cntaobao&status=1&charset=utf-8"><img border="0" src="http://amos.alicdn.com/realonline.aw?v=2&uid=%E5%A4%9C%E9%B9%B0%E9%97%AA%E5%AE%A2%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B%E7%BD%91&site=cntaobao&s=1&charset=utf-8" alt="购买教程"/></a>
 &nbsp;技术咨询：<a href="http://sighttp.qq.com/cgi-bin/check?sigkey=05a95cdf3fa1602e580171226ada682ed2d4a1cb451bf047f1e4969e5fc7b62d" target="_blank" onclick="var tempSrc=&#39;http://sighttp.qq.com/wpa.js?rantime=&#39;+Math.random()+&#39;&amp;sigkey=05a95cdf3fa1602e580171226ada682ed2d4a1cb451bf047f1e4969e5fc7b62d&#39;;var oldscript=document.getElementById(&#39;testJs&#39;);var newscript=document.createElement(&#39;script&#39;);newscript.setAttribute(&#39;type&#39;,&#39;text/javascript&#39;); newscript.setAttribute(&#39;id&#39;, &#39;testJs&#39;);newscript.setAttribute(&#39;src&#39;,tempSrc);if(oldscript == null){document.body.appendChild(newscript);}else{oldscript.parentNode.replaceChild(newscript, oldscript);}return false;"><img border="0" src="http://wpa.qq.com/pa?p=1:1416759661:10" alt="购买教程"/></a></p>
</div>
<div style="clear: both;"></div>
</div>
</div>

<div class="outcontainer" style="border: solid 1px white;border-left:0;border-right: 0;">
<div class="incontainner indexnews bottom">
<p><a href="/html/News/AboutUs_1.html" title="夜鹰教程网">关于我们</a> | <a href="/html/News/AboutUs_2.html" title="夜鹰教程网">广告投放</a> | <a href="/html/News/AboutUs_3.html" title="夜鹰教程网">购买教程</a> | <a href="/html/News/AboutUs_4.html" title="夜鹰教程网">网站建设</a> | <a href="/html/News/AboutUs_5.html" title="夜鹰教程网">技术辅导</a> | <a href="/html/News/AboutUs_8.html" title="夜鹰教程网">常见问题</a> | <a href="/html/News/AboutUs_6.html" title="夜鹰教程网">联系我们</a> | <a href="/html/News/AboutUs_7.html">友情链接</a> | <a href="http://sighttp.qq.com/cgi-bin/check?sigkey=05a95cdf3fa1602e580171226ada682ed2d4a1cb451bf047f1e4969e5fc7b62d"; target="_blank" onclick="var tempSrc='http://sighttp.qq.com/wpa.js?rantime='+Math.random()+'&sigkey=05a95cdf3fa1602e580171226ada682ed2d4a1cb451bf047f1e4969e5fc7b62d';var oldscript=document.getElementById('testJs');var newscript=document.createElement('script');newscript.setAttribute('type','text/javascript'); newscript.setAttribute('id', 'testJs');newscript.setAttribute('src',tempSrc);if(oldscript == null){document.body.appendChild(newscript);}else{oldscript.parentNode.replaceChild(newscript, oldscript);}return false;"><img border="0" SRC='http://wpa.qq.com/pa?p=1:1416759661:10' alt="购买教程"></a>
<p><script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_951426'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s4.cnzz.com/stat.php%3Fid%3D951426%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));</script>Nighthawk Tutorials Network <a href="/list.html">快捷购买教程</a></p>
<p><a href="http://www.yyjcw.com" style="color:#801326;">夜鹰教程网</a> 版权所有 <a href="http://www.yyjcw.com" style="color:#801326;">www.yyjcw.com</a> All rights reserved 备案号：<a href="http://www.miibeian.gov.cn/" style="color:#801326;" target="_blank">蜀ICP备08011740号3</a></p>
                            <p>&nbsp;</p>
</div>
</div>                           

    
    </form>

    <script type="text/javascript">
        function AutoScroll(obj) {
            $(obj).find("ul:first").animate({
                marginTop: "-24px"
            }, 500, function() {
                $(this).css({ marginTop: "0px" }).find("li:first").appendTo(this);
            });
        }
        
        $(function() {
            var sliding=setInterval('AutoScroll(".topNotice")', 5000);
            $(".topNotice").hover(function() {
                clearInterval(sliding);
            }, function() {
                sliding = setInterval('AutoScroll(".topNotice")', 5000);
            });        
        })     

        
        
        //更新浏览次数
        UpdateVisitCount();
        function UpdateVisitCount() {

            $.post("/common/ajax/ajax.aspx?" + Math.random(), { w: "UpdateVisitCount", _id: "1779" }, function(data) {

            })
        }
        t();
    </script>
	

 <div style="background-color:Black; width:100%; height:30px;position:fixed;left:0;bottom:0;filter:alpha(opacity=80); z-index:100; text-align:center; color:White; font-size:14px; font-weight:bolder; line-height:30px;"> <a href="http://www.yyjcw.com/list.html" style="color:White;">出售</a><a href="http://www.yyjcw.com/list.html" style="color:White;">asp.net系列视频教程</a> <a href="http://www.yyjcw.com/list.html" style="color:White;">高清原创版</a>
每天晚上20：30--23：00在线
<a href="http://www.yyjcw.com/list.html" style="color:White;">按照编号从简单到高级</a>
<a href="http://www.yyjcw.com/list.html" style="color:White;">http://www.yyjcw.com/list.html</a> </div>
</body>
</html>

